<?xml version="1.0" encoding="ISO-8859-1"?>

<!--
~ Copyright (c) 2023, WSO2 LLC. (http://www.wso2.org) All Rights Reserved.
~
~ Licensed under the Apache License, Version 2.0 (the "License");
~ you may not use this file except in compliance with the License.
~ You may obtain a copy of the License at
~
~ http://www.apache.org/licenses/LICENSE-2.0
~
~ Unless required by applicable law or agreed to in writing, software
~ distributed under the License is distributed on an "AS IS" BASIS,
~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
~ See the License for the specific language governing permissions and
~ limitations under the License.
  -->
<wso2registry xmlns:svns="http://org.wso2.securevault/configuration">

    <!--
    For details on configuring different config & governance registries see;
    http://wso2.org/library/tutorials/2010/04/sharing-registry-space-across-multiple-product-instances
    -->

    <currentDBConfig>wso2registry</currentDBConfig>
    <readOnly>false</readOnly>
    <enableCache>true</enableCache>
    <registryRoot>/</registryRoot>

    <dbConfig name="wso2registry">
    {% if registry.use_shared_db_as_datasource is sameas true %}
        <dataSource>jdbc/SHARED_DB</dataSource>
    {% else %}
        <dataSource>jdbc/WSO2CarbonDB</dataSource>
    {% endif %}
    </dbConfig>
    {% if registry.enable_mount is not defined or registry.enable_mount is sameas true %}
    <dbConfig name="govregistry">
        <dataSource>jdbc/SHARED_DB</dataSource>
    </dbConfig>
    <dbConfig name="configregistry">
    {% if database.config is defined%}
        <dataSource>jdbc/WSO2CONFIG_DB</dataSource>
    {% else %}
        <dataSource>jdbc/SHARED_DB</dataSource>
    {% endif %}
    </dbConfig>

    <remoteInstance url="https://{{server.hostname}}">
        <id>gov</id>
        <cacheId>{{governance_data.cache_id}}</cacheId>
        <dbConfig>govregistry</dbConfig>
        <readOnly>false</readOnly>
        <enableCache>{{governance_data.enable_cache}}</enableCache>
        <registryRoot>/</registryRoot>
    </remoteInstance>

 <remoteInstance url="https://{{server.hostname}}">
        <id>conf</id>
        <cacheId>{{config_data.cache_id}}</cacheId>
        <dbConfig>configregistry</dbConfig>
        <readOnly>false</readOnly>
        <enableCache>{{config_data.enable_cache}}</enableCache>
        <registryRoot>/</registryRoot>
    </remoteInstance>

    <mount path="/_system/governance" overwrite="true">
        <instanceId>gov</instanceId>
        <targetPath>{{governance_data.path}}</targetPath>
    </mount>
    <mount path="/_system/config" overwrite="true">
        <instanceId>conf</instanceId>
        <targetPath>{{config_data.path}}</targetPath>
    </mount>
    {% endif %}
   <!--<handler class="org.wso2.carbon.registry.extensions.handlers.SynapseRepositoryHandler">
        <filter class="org.wso2.carbon.registry.core.jdbc.handlers.filters.MediaTypeMatcher">
            <property name="mediaType">application/vnd.apache.synapse</property>
        </filter>
    </handler>

    <handler class="org.wso2.carbon.registry.extensions.handlers.SynapseRepositoryHandler">
        <filter class="org.wso2.carbon.registry.core.jdbc.handlers.filters.MediaTypeMatcher">
            <property name="mediaType">application/vnd.apache.esb</property>
        </filter>
    </handler>

    <handler class="org.wso2.carbon.registry.extensions.handlers.Axis2RepositoryHandler">
        <filter class="org.wso2.carbon.registry.core.jdbc.handlers.filters.MediaTypeMatcher">
            <property name="mediaType">application/vnd.apache.axis2</property>
        </filter>
    </handler>

    <handler class="org.wso2.carbon.registry.extensions.handlers.Axis2RepositoryHandler">
        <filter class="org.wso2.carbon.registry.core.jdbc.handlers.filters.MediaTypeMatcher">
            <property name="mediaType">application/vnd.apache.wsas</property>
        </filter>
    </handler>

    <handler class="org.wso2.carbon.registry.extensions.handlers.WSDLMediaTypeHandler">
        <filter class="org.wso2.carbon.registry.core.jdbc.handlers.filters.MediaTypeMatcher">
            <property name="mediaType">application/wsdl+xml</property>
        </filter>
    </handler>

    <handler class="org.wso2.carbon.registry.extensions.handlers.XSDMediaTypeHandler">
        <filter class="org.wso2.carbon.registry.core.jdbc.handlers.filters.MediaTypeMatcher">
            <property name="mediaType">application/x-xsd+xml</property>
        </filter>
    </handler> -->

    <!--remoteInstance url="https://localhost:9443/registry">
        <id>instanceid</id>
        <username>username</username>
        <password>password</password>
    </remoteInstance-->

    <!--remoteInstance url="https://localhost:9443/registry">
        <id>instanceid</id>
        <dbConfig>wso2registry</dbConfig>
        <readOnly>false</readOnly>
        <enableCache>true</enableCache>
        <registryRoot>/</registryRoot>
    </remoteInstance-->

    <!--mount path="/_system/config" overwrite="true|false|virtual">
        <instanceId>instanceid</instanceId>
        <targetPath>/_system/nodes</targetPath>
    </mount-->

    
    <versionResourcesOnChange>{{versioning_configuration.enable_version_resources_on_change}}</versionResourcesOnChange>

    <!-- NOTE: You can edit the options under "StaticConfiguration" only before the
     startup. -->
     <staticConfiguration>
            <versioningProperties>{{versioning_configuration.enable_versioning_properties}}</versioningProperties>
            <versioningComments>{{versioning_configuration.enable_versioning_comments}}</versioningComments>
            <versioningTags>{{versioning_configuration.enable_versioning_tags}}</versioningTags>
            <versioningRatings>{{versioning_configuration.enable_versioning_ratings}}</versioningRatings>
      </staticConfiguration>
</wso2registry>
