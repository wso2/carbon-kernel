/*
Copyright (c) 2007, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.net/yui/license.txt
version: 2.3.1
*/
(function(){var B=YAHOO.util.Dom,A=YAHOO.util.Event,D=YAHOO.lang;YAHOO.widget.Toolbar=function(G,F){if(D.isObject(arguments[0])&&!B.get(G).nodeType){F=G;}var I=(F||{});var H={element:null,attributes:I};if(D.isString(G)&&B.get(G)){H.element=B.get(G);}else{if(D.isObject(G)&&B.get(G)&&B.get(G).nodeType){H.element=B.get(G);}}if(!H.element){H.element=document.createElement("DIV");H.element.id=B.generateId();if(I.container&&B.get(I.container)){B.get(I.container).appendChild(H.element);}}if(!H.element.id){H.element.id=((D.isString(G))?G:B.generateId());}var E=document.createElement("DIV");H.attributes.cont=E;B.addClass(E,"yui-toolbar-subcont");H.element.appendChild(E);H.attributes.element=H.element;H.attributes.id=H.element.id;YAHOO.widget.Toolbar.superclass.constructor.call(this,H.element,H.attributes);};function C(H,E,I){B.addClass(this.element,"yui-toolbar-"+I.get("value")+"-menu");if(B.hasClass(I._button.parentNode.parentNode,"yui-toolbar-select")){B.addClass(this.element,"yui-toolbar-select-menu");}var F=this.getItems();for(var G=0;G<F.length;G++){B.addClass(F[G].element,"yui-toolbar-"+I.get("value")+"-"+((F[G].value)?F[G].value.replace(/ /g,"-").toLowerCase():F[G]._oText.nodeValue.replace(/ /g,"-").toLowerCase()));B.addClass(F[G].element,"yui-toolbar-"+I.get("value")+"-"+((F[G].value)?F[G].value.replace(/ /g,"-"):F[G]._oText.nodeValue.replace(/ /g,"-")));}}YAHOO.extend(YAHOO.widget.Toolbar,YAHOO.util.Element,{dd:null,_colorData:{"#111111":"Obsidian","#2D2D2D":"Dark Gray","#434343":"Shale","#5B5B5B":"Flint","#737373":"Gray","#8B8B8B":"Concrete","#A2A2A2":"Gray","#B9B9B9":"Titanium","#000000":"Black","#D0D0D0":"Light Gray","#E6E6E6":"Silver","#FFFFFF":"White","#BFBF00":"Pumpkin","#FFFF00":"Yellow","#FFFF40":"Banana","#FFFF80":"Pale Yellow","#FFFFBF":"Butter","#525330":"Raw Siena","#898A49":"Mildew","#AEA945":"Olive","#7F7F00":"Paprika","#C3BE71":"Earth","#E0DCAA":"Khaki","#FCFAE1":"Cream","#60BF00":"Cactus","#80FF00":"Chartreuse","#A0FF40":"Green","#C0FF80":"Pale Lime","#DFFFBF":"Light Mint","#3B5738":"Green","#668F5A":"Lime Gray","#7F9757":"Yellow","#407F00":"Clover","#8A9B55":"Pistachio","#B7C296":"Light Jade","#E6EBD5":"Breakwater","#00BF00":"Spring Frost","#00FF80":"Pastel Green","#40FFA0":"Light Emerald","#80FFC0":"Sea Foam","#BFFFDF":"Sea Mist","#033D21":"Dark Forrest","#438059":"Moss","#7FA37C":"Medium Green","#007F40":"Pine","#8DAE94":"Yellow Gray Green","#ACC6B5":"Aqua Lung","#DDEBE2":"Sea Vapor","#00BFBF":"Fog","#00FFFF":"Cyan","#40FFFF":"Turquoise Blue","#80FFFF":"Light Aqua","#BFFFFF":"Pale Cyan","#033D3D":"Dark Teal","#347D7E":"Gray Turquoise","#609A9F":"Green Blue","#007F7F":"Seaweed","#96BDC4":"Green Gray","#B5D1D7":"Soapstone","#E2F1F4":"Light Turquoise","#0060BF":"Summer Sky","#0080FF":"Sky Blue","#40A0FF":"Electric Blue","#80C0FF":"Light Azure","#BFDFFF":"Ice Blue","#1B2C48":"Navy","#385376":"Biscay","#57708F":"Dusty Blue","#00407F":"Sea Blue","#7792AC":"Sky Blue Gray","#A8BED1":"Morning Sky","#DEEBF6":"Vapor","#0000BF":"Deep Blue","#0000FF":"Blue","#4040FF":"Cerulean Blue","#8080FF":"Evening Blue","#BFBFFF":"Light Blue","#212143":"Deep Indigo","#373E68":"Sea Blue","#444F75":"Night Blue","#00007F":"Indigo Blue","#585E82":"Dockside","#8687A4":"Blue Gray","#D2D1E1":"Light Blue Gray","#6000BF":"Neon Violet","#8000FF":"Blue Violet","#A040FF":"Violet Purple","#C080FF":"Violet Dusk","#DFBFFF":"Pale Lavender","#302449":"Cool Shale","#54466F":"Dark Indigo","#655A7F":"Dark Violet","#40007F":"Violet","#726284":"Smoky Violet","#9E8FA9":"Slate Gray","#DCD1DF":"Violet White","#BF00BF":"Royal Violet","#FF00FF":"Fuchsia","#FF40FF":"Magenta","#FF80FF":"Orchid","#FFBFFF":"Pale Magenta","#4A234A":"Dark Purple","#794A72":"Medium Purple","#936386":"Cool Granite","#7F007F":"Purple","#9D7292":"Purple Moon","#C0A0B6":"Pale Purple","#ECDAE5":"Pink Cloud","#BF005F":"Hot Pink","#FF007F":"Deep Pink","#FF409F":"Grape","#FF80BF":"Electric Pink","#FFBFDF":"Pink","#451528":"Purple Red","#823857":"Purple Dino","#A94A76":"Purple Gray","#7F003F":"Rose","#BC6F95":"Antique Mauve","#D8A5BB":"Cool Marble","#F7DDE9":"Pink Granite","#C00000":"Apple","#FF0000":"Fire Truck","#FF4040":"Pale Red","#FF8080":"Salmon","#FFC0C0":"Warm Pink","#441415":"Sepia","#82393C":"Rust","#AA4D4E":"Brick","#800000":"Brick Red","#BC6E6E":"Mauve","#D8A3A4":"Shrimp Pink","#F8DDDD":"Shell Pink","#BF5F00":"Dark Orange","#FF7F00":"Orange","#FF9F40":"Grapefruit","#FFBF80":"Canteloupe","#FFDFBF":"Wax","#482C1B":"Dark Brick","#855A40":"Dirt","#B27C51":"Tan","#7F3F00":"Nutmeg","#C49B71":"Mustard","#E1C4A8":"Pale Tan","#FDEEE0":"Marble"},_colorPicker:null,STR_COLLAPSE:"Collapse Toolbar",STR_SPIN_LABEL:"Spin Button with value {VALUE}. Use Control Shift Up Arrow and Control Shift Down arrow keys to increase or decrease the value.",STR_SPIN_UP:"Click to increase the value of this input",STR_SPIN_DOWN:"Click to decrease the value of this input",_titlebar:null,_disabled:null,browser:YAHOO.env.ua,_buttonList:null,_buttonGroupList:null,_sep:null,_sepCount:null,_dragHandle:null,_toolbarConfigs:{renderer:true},CLASS_CONTAINER:"yui-toolbar-container",CLASS_DRAGHANDLE:"yui-toolbar-draghandle",CLASS_SEPARATOR:"yui-toolbar-separator",CLASS_DISABLED:"yui-toolbar-disabled",CLASS_PREFIX:"yui-toolbar",init:function(F,E){YAHOO.widget.Toolbar.superclass.init.call(this,F,E);},initAttributes:function(E){YAHOO.widget.Toolbar.superclass.initAttributes.call(this,E);var F=this.get("element");this.addClass(this.CLASS_CONTAINER);this.setAttributeConfig("buttons",{value:[],writeOnce:true,method:function(H){for(var G in H){if(D.hasOwnProperty(H,G)){if(H[G].type=="separator"){this.addSeparator();}else{if(H[G].group!==undefined){this.addButtonGroup(H[G]);}else{this.addButton(H[G]);}}}}}});this.setAttributeConfig("disabled",{value:false,method:function(I){if(this.get("disabled")===I){return false;}if(!D.isObject(this._disabled)){this._disabled={};}if(I){this.addClass(this.CLASS_DISABLED);this.set("draggable",false);}else{this.removeClass(this.CLASS_DISABLED);if(this._configs.draggable._initialConfig.value){this.set("draggable",true);
}}var G=this._buttonList.length;for(var H=0;H<G;H++){if(I){if(this._buttonList[H].get("disabled")){this._disabled[H]=true;}else{this._disabled[H]=null;}this.disableButton(this._buttonList[H].get("id"));}else{var K=this._buttonList[H];var J=K._configs.disabled._initialConfig.value;if(this._disabled[H]===true){J=true;}if(!J){this.enableButton(K.get("id"));}}}if(!I){this._disabled={};}}});this.setAttributeConfig("cont",{value:E.cont,readOnly:true});this.setAttributeConfig("grouplabels",{value:E.grouplabels||true,method:function(G){if(G){B.removeClass(this.get("cont"),(this.CLASS_PREFIX+"-nogrouplabels"));}else{B.addClass(this.get("cont"),(this.CLASS_PREFIX+"-nogrouplabels"));}}});this.setAttributeConfig("titlebar",{value:false,method:function(H){if(H){if(this._titlebar&&this._titlebar.parentNode){this._titlebar.parentNode.removeChild(this._titlebar);}this._titlebar=document.createElement("DIV");B.addClass(this._titlebar,this.CLASS_PREFIX+"-titlebar");if(D.isString(H)){var G=document.createElement("h2");G.tabIndex="-1";G.innerHTML=H;this._titlebar.appendChild(G);}if(this.get("firstChild")){this.insertBefore(this._titlebar,this.get("firstChild"));}else{this.appendChild(this._titlebar);}if(this.get("collapse")){this.set("collapse",true);}}else{if(this._titlebar){if(this._titlebar&&this._titlebar.parentNode){this._titlebar.parentNode.removeChild(this._titlebar);}}}}});this.setAttributeConfig("collapse",{value:false,method:function(I){var H=null;var G=B.getElementsByClassName("collapse","span",this._titlebar);if(I){if(G.length>0){return true;}H=document.createElement("SPAN");H.innerHTML="X";H.title=this.STR_COLLAPSE;B.addClass(H,"collapse");this._titlebar.appendChild(H);A.addListener(H,"click",function(){if(B.hasClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed")){this.collapse(false);}else{this.collapse();}},this,true);}else{H=B.getElementsByClassName("collapse","span",this._titlebar);if(H[0]){if(B.hasClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed")){this.collapse(false);}H[0].parentNode.removeChild(H[0]);}}}});this.setAttributeConfig("draggable",{value:(E.draggable||false),method:function(G){var H=this.get("element");if(G&&!this.get("titlebar")){if(!this._dragHandle){this._dragHandle=document.createElement("SPAN");this._dragHandle.innerHTML="|";this._dragHandle.setAttribute("title","Click to drag the toolbar");this._dragHandle.id=this.get("id")+"_draghandle";B.addClass(this._dragHandle,this.CLASS_DRAGHANDLE);if(this.get("cont").hasChildNodes()){this.get("cont").insertBefore(this._dragHandle,this.get("cont").firstChild);}else{this.get("cont").appendChild(this._dragHandle);}this.dd=new YAHOO.util.DD(this.get("id"));this.dd.setHandleElId(this._dragHandle.id);}}else{if(this._dragHandle){this._dragHandle.parentNode.removeChild(this._dragHandle);this._dragHandle=null;this.dd=null;}}if(this._titlebar){if(G){this.dd=new YAHOO.util.DD(this.get("id"));this.dd.setHandleElId(this._titlebar);B.addClass(this._titlebar,"draggable");}else{B.removeClass(this._titlebar,"draggable");if(this.dd){this.dd.unreg();this.dd=null;}}}},validator:function(H){var G=true;if(!YAHOO.util.DD){G=false;}return G;}});},addButtonGroup:function(I){if(!this.get("element")){this._queue[this._queue.length]=["addButtonGroup",arguments];return false;}if(!this.hasClass(this.CLASS_PREFIX+"-grouped")){this.addClass(this.CLASS_PREFIX+"-grouped");}var J=document.createElement("DIV");B.addClass(J,this.CLASS_PREFIX+"-group");B.addClass(J,this.CLASS_PREFIX+"-group-"+I.group);if(I.label){var F=document.createElement("h3");F.innerHTML=I.label;J.appendChild(F);}if(!this.get("grouplabels")){B.addClass(this.get("cont"),this.CLASS_PREFIX,"-nogrouplabels");}this.get("cont").appendChild(J);var H=document.createElement("ul");J.appendChild(H);if(!this._buttonGroupList){this._buttonGroupList={};}this._buttonGroupList[I.group]=H;for(var G=0;G<I.buttons.length;G++){var E=document.createElement("li");E.className=this.CLASS_PREFIX+"-groupitem";H.appendChild(E);if((I.buttons[G].type!==undefined)&&I.buttons[G].type=="separator"){this.addSeparator(E);}else{I.buttons[G].container=E;this.addButton(I.buttons[G]);}}},addButtonToGroup:function(G,H,I){var F=this._buttonGroupList[H];var E=document.createElement("li");E.className=this.CLASS_PREFIX+"-groupitem";G.container=E;this.addButton(G,I);F.appendChild(E);},addButton:function(P,E){if(!this.get("element")){this._queue[this._queue.length]=["addButton",arguments];return false;}if(!this._buttonList){this._buttonList=[];}this._configs.buttons.value[this._configs.buttons.value.length]=P;if(!P.container){P.container=this.get("cont");}if((P.type=="menu")||(P.type=="split")||(P.type=="select")){if(D.isArray(P.menu)){for(var K in P.menu){if(D.hasOwnProperty(P.menu,K)){var S={fn:function(V,T,U){if(!P.menucmd){P.menucmd=P.value;}P.value=((U.value)?U.value:U._oText.nodeValue);},scope:this};P.menu[K].onclick=S;}}}}var N={};for(var I in P){if(D.hasOwnProperty(P,I)){if(!this._toolbarConfigs[I]){N[I]=P[I];}}}if(P.type=="select"){N.type="menu";}if(P.type=="spin"){N.type="push";}if(N.type=="color"){N=this._makeColorButton(N);}if(N.menu){if(P.menu instanceof YAHOO.widget.Overlay){P.menu.showEvent.subscribe(function(){this._button=N;});}else{for(var J=0;J<N.menu.length;J++){if(!N.menu[J].value){N.menu[J].value=N.menu[J].text;}}if(this.browser.webkit){N.focusmenu=false;}}}var L=new YAHOO.widget.Button(N);if(this.get("disabled")){L.set("disabled",true);}if(!P.id){P.id=L.get("id");}if(E){var H=L.get("element");var F=null;if(E.get){F=E.get("element").nextSibling;}else{if(E.nextSibling){F=E.nextSibling;}}if(F){F.parentNode.insertBefore(H,F);}}L.addClass(this.CLASS_PREFIX+"-"+L.get("value"));var O=document.createElement("span");O.className=this.CLASS_PREFIX+"-icon";L.get("element").insertBefore(O,L.get("firstChild"));var Q=document.createElement("a");Q.innerHTML=L._button.innerHTML;Q.href="#";A.on(Q,"click",function(T){A.stopEvent(T);});L._button.parentNode.replaceChild(Q,L._button);L._button=Q;if(P.type=="select"){L.addClass(this.CLASS_PREFIX+"-select");
}if(P.type=="spin"){if(!D.isArray(P.range)){P.range=[10,100];}this._makeSpinButton(L,P);}L.get("element").setAttribute("title",L.get("label"));if(P.type!="spin"){if(N.menu instanceof YAHOO.widget.Overlay){var M=function(V){var T=true;if(V.keyCode&&(V.keyCode==9)){T=false;}if(T){this._colorPicker._button=P.value;var U=L.getMenu().element;if(U.style.visibility=="hidden"){L.getMenu().show();}else{L.getMenu().hide();}}YAHOO.util.Event.stopEvent(V);};L.on("mousedown",M,P,this);L.on("keydown",M,P,this);}else{if((P.type!="menu")&&(P.type!="select")){L.on("keypress",this._buttonClick,P,this);L.on("mousedown",function(T){YAHOO.util.Event.stopEvent(T);this._buttonClick(T,P);},P,this);L.on("click",function(T){YAHOO.util.Event.stopEvent(T);});}else{L.on("mousedown",function(T){YAHOO.util.Event.stopEvent(T);});L.on("click",function(T){YAHOO.util.Event.stopEvent(T);});var R=this;L.getMenu().mouseDownEvent.subscribe(function(V,U){var T=U[1];YAHOO.util.Event.stopEvent(U[0]);L._onMenuClick(U[0],L);if(!P.menucmd){P.menucmd=P.value;}P.value=((T.value)?T.value:T._oText.nodeValue);R._buttonClick.call(R,U[1],P);L._hideMenu();return false;});L.getMenu().clickEvent.subscribe(function(U,T){YAHOO.util.Event.stopEvent(T[0]);});}}}else{L.on("mousedown",function(T){YAHOO.util.Event.stopEvent(T);});L.on("click",function(T){YAHOO.util.Event.stopEvent(T);});}if(this.browser.ie){L.DOM_EVENTS.focusin=true;L.DOM_EVENTS.focusout=true;L.on("focusin",function(T){YAHOO.util.Event.stopEvent(T);},P,this);L.on("focusout",function(T){YAHOO.util.Event.stopEvent(T);},P,this);L.on("click",function(T){YAHOO.util.Event.stopEvent(T);},P,this);}if(this.browser.webkit){L.hasFocus=function(){return true;};}this._buttonList[this._buttonList.length]=L;if((P.type=="menu")||(P.type=="split")||(P.type=="select")){if(D.isArray(P.menu)){var G=L.getMenu();G.renderEvent.subscribe(C,L);if(P.renderer){G.renderEvent.subscribe(P.renderer,L);}}}return P;},addSeparator:function(E,H){if(!this.get("element")){this._queue[this._queue.length]=["addSeparator",arguments];return false;}var F=((E)?E:this.get("cont"));if(!this.get("element")){this._queue[this._queue.length]=["addSeparator",arguments];return false;}if(this._sepCount===null){this._sepCount=0;}if(!this._sep){this._sep=document.createElement("SPAN");B.addClass(this._sep,this.CLASS_SEPARATOR);this._sep.innerHTML="|";}var G=this._sep.cloneNode(true);this._sepCount++;B.addClass(G,this.CLASS_SEPARATOR+"-"+this._sepCount);if(H){var I=null;if(H.get){I=H.get("element").nextSibling;}else{if(H.nextSibling){I=H.nextSibling;}else{I=H;}}if(I){if(I==H){I.parentNode.appendChild(G);}else{I.parentNode.insertBefore(G,I);}}}else{F.appendChild(G);}return G;},_createColorPicker:function(J){if(B.get(J+"_colors")){B.get(J+"_colors").parentNode.removeChild(B.get(J+"_colors"));}var F=document.createElement("div");F.className="yui-toolbar-colors";F.id=J+"_colors";F.style.display="none";A.on(window,"load",function(){document.body.appendChild(F);},this,true);this._colorPicker=F;var I="";for(var H in this._colorData){if(D.hasOwnProperty(this._colorData,H)){I+="<a style=\"background-color: "+H+"\" href=\"#\">"+H.replace("#","")+"</a>";}}I+="<span><em>X</em><strong></strong></span>";F.innerHTML=I;var G=F.getElementsByTagName("em")[0];var E=F.getElementsByTagName("strong")[0];A.on(F,"mouseover",function(L){var K=A.getTarget(L);if(K.tagName.toLowerCase()=="a"){G.style.backgroundColor=K.style.backgroundColor;E.innerHTML=this._colorData["#"+K.innerHTML]+"<br>"+K.innerHTML;}},this,true);A.on(F,"focus",function(K){A.stopEvent(K);});A.on(F,"click",function(K){A.stopEvent(K);});A.on(F,"mousedown",function(L){A.stopEvent(L);var K=A.getTarget(L);if(K.tagName.toLowerCase()=="a"){this.fireEvent("colorPickerClicked",{type:"colorPickerClicked",target:this,button:this._colorPicker._button,color:K.innerHTML,colorName:this._colorData["#"+K.innerHTML]});this.getButtonByValue(this._colorPicker._button).getMenu().hide();}},this,true);},_resetColorPicker:function(){var F=this._colorPicker.getElementsByTagName("em")[0];var E=this._colorPicker.getElementsByTagName("strong")[0];F.style.backgroundColor="transparent";E.innerHTML="";},_makeColorButton:function(E){if(!this._colorPicker){this._createColorPicker(this.get("id"));}E.type="color";E.menu=new YAHOO.widget.Overlay(this.get("id")+"_"+E.value+"_menu",{visbile:false,position:"absolute"});E.menu.setBody("");E.menu.render(this.get("cont"));E.menu.beforeShowEvent.subscribe(function(){E.menu.cfg.setProperty("zindex",5);E.menu.cfg.setProperty("context",[this.getButtonById(E.id).get("element"),"tl","bl"]);this._resetColorPicker();var F=this._colorPicker;if(F.parentNode){F.parentNode.removeChild(F);}E.menu.setBody("");E.menu.appendToBody(F);this._colorPicker.style.display="block";},this,true);return E;},_makeSpinButton:function(R,L){R.addClass(this.CLASS_PREFIX+"-spinbutton");var S=this,N=R._button.parentNode.parentNode,I=L.range,H=document.createElement("a"),G=document.createElement("a");H.href="#";G.href="#";H.className="up";H.title=this.STR_SPIN_UP;H.innerHTML=this.STR_SPIN_UP;G.className="down";G.title=this.STR_SPIN_DOWN;G.innerHTML=this.STR_SPIN_DOWN;N.appendChild(H);N.appendChild(G);var M=YAHOO.lang.substitute(this.STR_SPIN_LABEL,{VALUE:R.get("label")});R.set("title",M);var Q=function(T){T=((T<I[0])?I[0]:T);T=((T>I[1])?I[1]:T);return T;};var P=this.browser;var F=false;var K=this.STR_SPIN_LABEL;if(this._titlebar&&this._titlebar.firstChild){F=this._titlebar.firstChild;}var E=function(U){YAHOO.util.Event.stopEvent(U);if(!R.get("disabled")&&(U.keyCode!=9)){var V=parseInt(R.get("label"),10);V++;V=Q(V);R.set("label",""+V);var T=YAHOO.lang.substitute(K,{VALUE:R.get("label")});R.set("title",T);if(!P.webkit&&F){}S._buttonClick(U,L);}};var O=function(U){YAHOO.util.Event.stopEvent(U);if(!R.get("disabled")&&(U.keyCode!=9)){var V=parseInt(R.get("label"),10);V--;V=Q(V);R.set("label",""+V);var T=YAHOO.lang.substitute(K,{VALUE:R.get("label")});R.set("title",T);if(!P.webkit&&F){}S._buttonClick(U,L);}};var J=function(T){if(T.keyCode==38){E(T);
}else{if(T.keyCode==40){O(T);}else{if(T.keyCode==107&&T.shiftKey){E(T);}else{if(T.keyCode==109&&T.shiftKey){O(T);}}}}};R.on("keydown",J,this,true);A.on(H,"mousedown",function(T){A.stopEvent(T);},this,true);A.on(G,"mousedown",function(T){A.stopEvent(T);},this,true);A.on(H,"click",E,this,true);A.on(G,"click",O,this,true);},_buttonClick:function(L,F){var E=true;if(L&&L.type=="keypress"){if(L.keyCode==9){E=false;}else{if((L.keyCode===13)||(L.keyCode===0)||(L.keyCode===32)){}else{E=false;}}}if(E){var N=true,H=false;if(F.value){H=this.fireEvent(F.value+"Click",{type:F.value+"Click",target:this.get("element"),button:F});if(H===false){N=false;}}if(F.menucmd&&N){H=this.fireEvent(F.menucmd+"Click",{type:F.menucmd+"Click",target:this.get("element"),button:F});if(H===false){N=false;}}if(N){this.fireEvent("buttonClick",{type:"buttonClick",target:this.get("element"),button:F});}if(F.type=="select"){var K=this.getButtonById(F.id);var J=F.value;for(var I=0;I<F.menu.length;I++){if(F.menu[I].value==F.value){J=F.menu[I].text;break;}}K.set("label","<span class=\"yui-toolbar-"+F.menucmd+"-"+(F.value).replace(/ /g,"-").toLowerCase()+"\">"+J+"</span>");var M=K.getMenu().getItems();for(var G=0;G<M.length;G++){if(M[G].value.toLowerCase()==F.value.toLowerCase()){M[G].cfg.setProperty("checked",true);}else{M[G].cfg.setProperty("checked",false);}}}}if(L){A.stopEvent(L);}},getButtonById:function(G){var E=this._buttonList.length;for(var F=0;F<E;F++){if(this._buttonList[F].get("id")==G){return this._buttonList[F];}}return false;},getButtonByValue:function(K){var H=this.get("buttons");var F=H.length;for(var I=0;I<F;I++){if(H[I].group!==undefined){for(var E=0;E<H[I].buttons.length;E++){if((H[I].buttons[E].value==K)||(H[I].buttons[E].menucmd==K)){return this.getButtonById(H[I].buttons[E].id);}if(H[I].buttons[E].menu){for(var J=0;J<H[I].buttons[E].menu.length;J++){if(H[I].buttons[E].menu[J].value==K){return this.getButtonById(H[I].buttons[E].id);}}}}}else{if((H[I].value==K)||(H[I].menucmd==K)){return this.getButtonById(H[I].id);}if(H[I].menu){for(var G=0;G<H[I].menu.length;G++){if(H[I].menu[G].value==K){return this.getButtonById(H[I].id);}}}}}return false;},getButtonByIndex:function(E){if(this._buttonList[E]){return this._buttonList[E];}else{return false;}},getButtons:function(){return this._buttonList;},disableButton:function(F){var E=F;if(D.isString(F)){E=this.getButtonById(F);}if(D.isNumber(F)){E=this.getButtonByIndex(F);}if(!(E instanceof YAHOO.widget.Button)){E=this.getButtonByValue(F);}if(E instanceof YAHOO.widget.Button){E.set("disabled",true);}else{return false;}},enableButton:function(F){if(this.get("disabled")){return false;}var E=F;if(D.isString(F)){E=this.getButtonById(F);}if(D.isNumber(F)){E=this.getButtonByIndex(F);}if(!(E instanceof YAHOO.widget.Button)){E=this.getButtonByValue(F);}if(E instanceof YAHOO.widget.Button){if(E.get("disabled")){E.set("disabled",false);}}else{return false;}},selectButton:function(I,G){var F=I;if(I){if(D.isString(I)){F=this.getButtonById(I);}if(D.isNumber(I)){F=this.getButtonByIndex(I);}if(!(F instanceof YAHOO.widget.Button)){F=this.getButtonByValue(I);}if(F instanceof YAHOO.widget.Button){F.addClass("yui-button-selected");F.addClass("yui-button-"+F.get("value")+"-selected");if(G){var H=F.getMenu().getItems();for(var E=0;E<H.length;E++){if(H[E].value==G){H[E].cfg.setProperty("checked",true);F.set("label","<span class=\"yui-toolbar-"+F.get("value")+"-"+(G).replace(/ /g,"-").toLowerCase()+"\">"+H[E]._oText.nodeValue+"</span>");}else{H[E].cfg.setProperty("checked",false);}}}}else{return false;}}},deselectButton:function(F){var E=F;if(D.isString(F)){E=this.getButtonById(F);}if(D.isNumber(F)){E=this.getButtonByIndex(F);}if(!(E instanceof YAHOO.widget.Button)){E=this.getButtonByValue(F);}if(E instanceof YAHOO.widget.Button){E.removeClass("yui-button-selected");E.removeClass("yui-button-"+E.get("value")+"-selected");E.removeClass("yui-button-hover");}else{return false;}},deselectAllButtons:function(){var E=this._buttonList.length;for(var F=0;F<E;F++){this.deselectButton(this._buttonList[F]);}},disableAllButtons:function(){if(this.get("disabled")){return false;}var E=this._buttonList.length;for(var F=0;F<E;F++){this.disableButton(this._buttonList[F]);}},enableAllButtons:function(){if(this.get("disabled")){return false;}var E=this._buttonList.length;for(var F=0;F<E;F++){this.enableButton(this._buttonList[F]);}},resetAllButtons:function(I){if(!D.isObject(I)){I={};}if(this.get("disabled")){return false;}var E=this._buttonList.length;for(var F=0;F<E;F++){var H=this._buttonList[F];var G=H._configs.disabled._initialConfig.value;if(I[H.get("id")]){this.enableButton(H);this.selectButton(H);}else{if(G){this.disableButton(H);}else{this.enableButton(H);}this.deselectButton(H);}}},destroyButton:function(I){var G=I;if(D.isString(I)){G=this.getButtonById(I);}if(D.isNumber(I)){G=this.getButtonByIndex(I);}if(!(G instanceof YAHOO.widget.Button)){G=this.getButtonByValue(I);}if(G instanceof YAHOO.widget.Button){var H=G.get("id");G.destroy();var E=this._buttonList.length;for(var F=0;F<E;F++){if(this._buttonList[F].get("id")==H){this._buttonList[F]=null;}}}else{return false;}},destroy:function(){this.get("element").innerHTML="";this.get("element").className="";for(var E in this){if(D.hasOwnProperty(this,E)){this[E]=null;}}return true;},collapse:function(F){var E=B.getElementsByClassName("collapse","span",this._titlebar);if(F===false){B.removeClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed");if(E[0]){B.removeClass(E[0],"collapsed");}this.fireEvent("toolbarExpanded",{type:"toolbarExpanded",target:this});}else{if(E[0]){B.addClass(E[0],"collapsed");}B.addClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed");this.fireEvent("toolbarCollapsed",{type:"toolbarCollapsed",target:this});}},toString:function(){return"Toolbar (#"+this.get("element").id+") with "+this._buttonList.length+" buttons.";}});})();(function(){var C=YAHOO.util.Dom,A=YAHOO.util.Event,D=YAHOO.lang,B=YAHOO.widget.Toolbar;
YAHOO.widget.Editor=function(H,F){var J={element:null,attributes:(F||{})},L=null;if(D.isString(H)){L=H;}else{L=H.id;}J.element=H;var G=document.createElement("DIV");J.attributes.element_cont=new YAHOO.util.Element(G,{id:L+"_container"});var K=document.createElement("div");C.addClass(K,"first-child");J.attributes.element_cont.appendChild(K);if(!J.attributes.toolbar_cont){J.attributes.toolbar_cont=document.createElement("DIV");J.attributes.toolbar_cont.id=L+"_toolbar";K.appendChild(J.attributes.toolbar_cont);}var I=document.createElement("DIV");K.appendChild(I);J.attributes.editor_wrapper=I;YAHOO.widget.Editor.superclass.constructor.call(this,J.element,J.attributes);};function E(F){return F.replace(/ /g,"-").toLowerCase();}YAHOO.extend(YAHOO.widget.Editor,YAHOO.util.Element,{_lastButton:null,_baseHREF:function(){var F=document.location.href;if(F.indexOf("?")!==-1){F=F.substring(0,F.indexOf("?"));}F=F.substring(0,F.lastIndexOf("/"))+"/";return F;}(),_lastImage:null,_blankImageLoaded:false,_fixNodesTimer:null,_nodeChangeTimer:null,_lastNodeChangeEvent:null,_lastNodeChange:0,_rendered:false,DOMReady:null,_selection:null,_mask:null,_showingHiddenElements:null,currentWindow:null,currentEvent:null,operaEvent:null,currentFont:null,currentElement:[],dompath:null,beforeElement:null,afterElement:null,invalidHTML:{form:true,input:true,button:true,select:true,link:true,html:true,body:true,script:true,style:true,textarea:true},toolbar:null,_contentTimer:null,_contentTimerCounter:0,_disabled:["createlink","forecolor","backcolor","fontname","fontsize","superscript","subscript","removeformat","heading","indent"],_alwaysDisabled:{"outdent":true},_alwaysEnabled:{hiddenelements:true},_semantic:{"bold":true,"italic":true,"underline":true},_tag2cmd:{"b":"bold","strong":"bold","i":"italic","em":"italic","u":"underline","sup":"superscript","sub":"subscript","img":"insertimage","a":"createlink","ul":"insertunorderedlist","ol":"insertorderedlist"},_createIframe:function(){var J=document.createElement("iframe");J.id=this.get("id")+"_editor";var H={border:"0",frameBorder:"0",marginWidth:"0",marginHeight:"0",leftMargin:"0",topMargin:"0",allowTransparency:"true",width:"100%"};for(var I in H){if(D.hasOwnProperty(H,I)){J.setAttribute(I,H[I]);}}var G="javascript:;";if(this.browser.ie){G="about:blank";}J.setAttribute("src",G);var F=new YAHOO.util.Element(J);F.setStyle("zIndex","-1");return F;},_isElement:function(G,F){if(G&&G.tagName&&(G.tagName.toLowerCase()==F)){return true;}if(G&&G.getAttribute&&(G.getAttribute("tag")==F)){return true;}return false;},_getDoc:function(){var F=false;if(this.get){if(this.get("iframe")){if(this.get("iframe").get){if(this.get("iframe").get("element")){try{if(this.get("iframe").get("element").contentWindow){if(this.get("iframe").get("element").contentWindow.document){F=this.get("iframe").get("element").contentWindow.document;return F;}}}catch(G){}}}}}return false;},_getWindow:function(){return this.get("iframe").get("element").contentWindow;},_focusWindow:function(F){if(this.browser.webkit){if(F){this._getSelection().setBaseAndExtent(this._getDoc().body.firstChild,0,this._getDoc().body.firstChild,1);if(this.browser.webkit3){this._getSelection().collapseToStart();}else{this._getSelection().collapse(false);}}else{this._getSelection().setBaseAndExtent(this._getDoc().body,1,this._getDoc().body,1);if(this.browser.webkit3){this._getSelection().collapseToStart();}else{this._getSelection().collapse(false);}}this._getWindow().focus();}else{this._getWindow().focus();}},_hasSelection:function(){var H=this._getSelection();var F=this._getRange();var G=false;if(this.browser.ie||this.browser.opera){if(F.text){G=true;}if(F.html){G=true;}}else{if(this.browser.webkit){if(H+""!==""){G=true;}}else{if(H&&(H.toString()!=="")&&(H!==undefined)){G=true;}}}return G;},_getSelection:function(){var F=null;if(this._getDoc()&&this._getWindow()){if(this._getDoc().selection){F=this._getDoc().selection;}else{F=this._getWindow().getSelection();}if(this.browser.webkit){if(F.baseNode){this._selection={};this._selection.baseNode=F.baseNode;this._selection.baseOffset=F.baseOffset;this._selection.extentNode=F.extentNode;this._selection.extentOffset=F.extentOffset;}else{if(this._selection!==null){F=this._getWindow().getSelection();F.setBaseAndExtent(this._selection.baseNode,this._selection.baseOffset,this._selection.extentNode,this._selection.extentOffset);this._selection=null;}}}}return F;},_selectNode:function(G){if(!G){return false;}var H=this._getSelection(),F=null;if(this.browser.ie){try{F=this.getDoc().body.createTextRange();F.moveToElementText(G);F.select();}catch(I){}}else{if(this.browser.webkit){H.setBaseAndExtent(G,0,G,G.innerText.length);}else{F=this._getDoc().createRange();F.selectNodeContents(G);H.removeAllRanges();H.addRange(F);}}},_getRange:function(){var F=this._getSelection();if(F===null){return null;}if(this.browser.webkit&&!F.getRangeAt){var H=this._getDoc().createRange();try{H.setStart(F.anchorNode,F.anchorOffset);H.setEnd(F.focusNode,F.focusOffset);}catch(G){H=this._getWindow().getSelection()+"";}return H;}if(this.browser.ie||this.browser.opera){return F.createRange();}if(F.rangeCount>0){return F.getRangeAt(0);}return null;},_setDesignMode:function(F){try{this._getDoc().designMode=F;}catch(G){}},_toggleDesignMode:function(){var G=this._getDoc().designMode,F="on";if(G=="on"){F="off";}this._setDesignMode(F);return F;},_initEditor:function(){if(this.browser.ie){this._getDoc().body.style.margin="0";}this._setDesignMode("on");this.toolbar.on("buttonClick",this._handleToolbarClick,this,true);A.on(this._getDoc(),"mouseup",this._handleMouseUp,this,true);A.on(this._getDoc(),"mousedown",this._handleMouseDown,this,true);A.on(this._getDoc(),"click",this._handleClick,this,true);A.on(this._getDoc(),"dblclick",this._handleDoubleClick,this,true);A.on(this._getDoc(),"keypress",this._handleKeyPress,this,true);A.on(this._getDoc(),"keyup",this._handleKeyUp,this,true);A.on(this._getDoc(),"keydown",this._handleKeyDown,this,true);this.toolbar.set("disabled",false);
this.fireEvent("editorContentLoaded",{type:"editorLoaded",target:this});if(this.get("dompath")){var F=this;setTimeout(function(){F._writeDomPath.call(F);},150);}this.nodeChange(true);this._setBusy(true);},_checkLoaded:function(){this._contentTimerCounter++;if(this._contentTimer){clearTimeout(this._contentTimer);}if(this._contentTimerCounter>250){return false;}var H=false;try{if(this._getDoc()&&this._getDoc().body&&(this._getDoc().body._rteLoaded===true)){H=true;}}catch(G){H=false;}if(H===true){this._initEditor();}else{var F=this;this._contentTimer=setTimeout(function(){F._checkLoaded.call(F);},20);}},_setInitialContent:function(){var G=D.substitute(this.get("html"),{TITLE:this.STR_TITLE,CONTENT:this.get("element").value,CSS:this.get("css"),HIDDEN_CSS:this.get("hiddencss")}),F=true;if(this.browser.ie||this.browser.webkit||this.browser.opera){try{this._getDoc().open();this._getDoc().write(G);this._getDoc().close();}catch(H){F=false;}}else{this.get("iframe").get("element").src="data:text/html;charset=utf-8,"+encodeURIComponent(G);}if(F){this._checkLoaded();}},_setMarkupType:function(F){switch(this.get("markup")){case"css":this._setEditorStyle(true);break;case"default":this._setEditorStyle(false);break;case"semantic":case"xhtml":if(this._semantic[F]){this._setEditorStyle(false);}else{this._setEditorStyle(true);}break;}},_setEditorStyle:function(G){try{this._getDoc().execCommand("useCSS",false,!G);}catch(F){}},_getSelectedElement:function(){var H=this._getDoc(),F=null,G=null,I=null;if(this.browser.ie){this.currentEvent=this._getWindow().event;F=this._getRange();if(F){I=F.item?F.item(0):F.parentElement();if(I==H.body){I=null;}}if((this.currentEvent!==null)&&(this.currentEvent.keyCode===0)){I=A.getTarget(this.currentEvent);}}else{G=this._getSelection();F=this._getRange();if(!G||!F){return null;}if(!this._hasSelection()&&!this.browser.webkit){if(G.anchorNode&&(G.anchorNode.nodeType==3)){if(G.anchorNode.parentNode){I=G.anchorNode.parentNode;}if(G.anchorNode.nextSibling!=G.focusNode.nextSibling){I=G.anchorNode.nextSibling;}}if(this._isElement(I,"br")){I=null;}if(!I){I=F.commonAncestorContainer;if(!F.collapsed){if(F.startContainer==F.endContainer){if(F.startOffset-F.endOffset<2){if(F.startContainer.hasChildNodes()){I=F.startContainer.childNodes[F.startOffset];}}}}}}}if(this.currentEvent!==null){switch(this.currentEvent.type){case"click":case"mousedown":case"mouseup":I=A.getTarget(this.currentEvent);break;default:break;}}else{if(this.currentElement&&this.currentElement[0]){I=this.currentElement[0];}}if(this.browser.opera||this.browser.webkit){if(this.currentEvent&&!I){I=YAHOO.util.Event.getTarget(this.currentEvent);}}if(!I||!I.tagName){I=H.body;}if(this._isElement(I,"html")){I=H.body;}if(this._isElement(I,"body")){I=H.body;}if(I&&!I.parentNode){I=H.body;}if(I===undefined){I=null;}return I;},_getDomPath:function(){var F=this._getSelectedElement();var G=[];while(F!==null){if(F.ownerDocument!=this._getDoc()){F=null;break;}if(F.nodeName&&F.nodeType&&(F.nodeType==1)){G[G.length]=F;}if(this._isElement(F,"body")){break;}F=F.parentNode;}if(G.length===0){if(this._getDoc()&&this._getDoc().body){G[0]=this._getDoc().body;}}return G.reverse();},_writeDomPath:function(){var L=this._getDomPath(),J=[],H="",M="";for(var F=0;F<L.length;F++){var N=L[F].tagName.toLowerCase();if((N=="ol")&&(L[F].type)){N+=":"+L[F].type;}if(C.hasClass(L[F],"yui-tag")){N=L[F].getAttribute("tag");}if((this.get("markup")=="semantic")||(this.get("markup")=="xhtml")){switch(N){case"b":N="strong";break;case"i":N="em";break;}}if(!C.hasClass(L[F],"yui-non")){if(C.hasClass(L[F],"yui-tag")){M=N;}else{H=((L[F].className!=="")?"."+L[F].className.replace(/ /g,"."):"");if((H.indexOf("yui")!=-1)||(H.toLowerCase().indexOf("apple-style-span")!=-1)){H="";}M=N+((L[F].id)?"#"+L[F].id:"")+H;}switch(N){case"a":if(L[F].getAttribute("href")){M+=":"+L[F].getAttribute("href").replace("mailto:","").replace("http://","").replace("https://","");}break;case"img":var G=L[F].height;var K=L[F].width;if(L[F].style.height){G=parseInt(L[F].style.height,10);}if(L[F].style.width){K=parseInt(L[F].style.width,10);}M+="("+G+"x"+K+")";break;}if(M.length>10){M="<span title=\""+M+"\">"+M.substring(0,10)+"...</span>";}else{M="<span title=\""+M+"\">"+M+"</span>";}J[J.length]=M;}}var I=J.join(" "+this.SEP_DOMPATH+" ");if(this.dompath.innerHTML!=I){this.dompath.innerHTML=I;}},_fixNodes:function(){for(var I in this.invalidHTML){if(D.hasOwnProperty(this.invalidHTML,I)){var K=this._getDoc().body.getElementsByTagName(I);for(var L=0;L<K.length;L++){if(K[L].parentNode){K[L].parentNode.removeChild(K[L]);}}}}var M=this._getDoc().getElementsByTagName("img");C.addClass(M,"yui-img");var J="";for(var G=0;G<M.length;G++){if(M[G].getAttribute("href",2)){J=M[G].getAttribute("src",2);if(this._isLocalFile(J)){C.addClass(M[G],this.CLASS_LOCAL_FILE);}else{C.removeClass(M[G],this.CLASS_LOCAL_FILE);}}}var H=this._getDoc().body.getElementsByTagName("a");for(var F=0;F<H.length;F++){if(H[F].getAttribute("href",2)){J=H[F].getAttribute("href",2);if(this._isLocalFile(J)){C.addClass(H[F],this.CLASS_LOCAL_FILE);}else{C.removeClass(H[F],this.CLASS_LOCAL_FILE);}}}},_showHidden:function(){if(this._showingHiddenElements){this._showingHiddenElements=false;this.toolbar.deselectButton("hiddenelements");C.removeClass(this._getDoc().body,this.CLASS_HIDDEN);}else{this._showingHiddenElements=true;C.addClass(this._getDoc().body,this.CLASS_HIDDEN);this.toolbar.selectButton("hiddenelements");}},_setCurrentEvent:function(F){this.currentEvent=F;},_handleClick:function(G){this._setCurrentEvent(G);if(this.currentWindow){this.closeWindow();}if(YAHOO.widget.EditorInfo.window.win&&YAHOO.widget.EditorInfo.window.scope){YAHOO.widget.EditorInfo.window.scope.closeWindow.call(YAHOO.widget.EditorInfo.window.scope);}if(this.browser.webkit){var F=A.getTarget(G);if(this._isElement(F,"a")||this._isElement(F.parentNode,"a")){A.stopEvent(G);this.nodeChange();}}else{this.nodeChange();}},_handleMouseUp:function(G){this._setCurrentEvent(G);var F=this;
if(this.browser.opera){var H=A.getTarget(G);if(this._isElement(H,"img")){this.nodeChange();if(this.operaEvent){clearTimeout(this.operaEvent);this.operaEvent=null;this._handleDoubleClick(G);}else{this.operaEvent=window.setTimeout(function(){F.operaEvent=false;},700);}}}if(this.browser.webkit||this.browser.opera){if(this.browser.webkit){A.stopEvent(G);}}this.nodeChange();this.fireEvent("editorMouseUp",{type:"editorMouseUp",target:this,ev:G});},_handleMouseDown:function(F){this._setCurrentEvent(F);var G=A.getTarget(F);if(this.browser.webkit&&this._hasSelection()){var H=this._getSelection();if(!this.browser.webkit3){H.collapse(true);}else{H.collapseToStart();}}if(this.browser.webkit&&this._lastImage){C.removeClass(this._lastImage,"selected");this._lastImage=null;}if(this._isElement(G,"img")||this._isElement(G,"a")){if(this.browser.webkit){A.stopEvent(F);if(this._isElement(G,"img")){C.addClass(G,"selected");this._lastImage=G;}}this.nodeChange();}this.fireEvent("editorMouseDown",{type:"editorMouseDown",target:this,ev:F});},_handleDoubleClick:function(F){this._setCurrentEvent(F);var G=A.getTarget(F);if(this._isElement(G,"img")){this.currentElement[0]=G;this.toolbar.fireEvent("insertimageClick",{type:"insertimageClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});}else{if(this._isElement(G,"a")){this.currentElement[0]=G;this.toolbar.fireEvent("createlinkClick",{type:"createlinkClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});}}this.nodeChange();this.fireEvent("editorDoubleClick",{type:"editorDoubleClick",target:this,ev:F});},_handleKeyUp:function(G){this._setCurrentEvent(G);switch(G.keyCode){case 37:case 38:case 39:case 40:case 46:case 8:case 87:if((G.keyCode==87)&&this.currentWindow&&G.shiftKey&&G.ctrlKey){this.closeWindow();}else{if(!this.browser.ie){if(this._nodeChangeTimer){clearTimeout(this._nodeChangeTimer);}var F=this;this._nodeChangeTimer=setTimeout(function(){F._nodeChangeTimer=null;F.nodeChange.call(F);},100);}else{this.nodeChange();}}break;}this.fireEvent("editorKeyUp",{type:"editorKeyUp",target:this,ev:G});},_handleKeyPress:function(F){this._setCurrentEvent(F);this.fireEvent("editorKeyPress",{type:"editorKeyPress",target:this,ev:F});},_handleKeyDown:function(I){this._setCurrentEvent(I);if(this.currentWindow){this.closeWindow();}if(YAHOO.widget.EditorInfo.window.win&&YAHOO.widget.EditorInfo.window.scope){YAHOO.widget.EditorInfo.window.scope.closeWindow.call(YAHOO.widget.EditorInfo.window.scope);}var H=false,J=null,G=false;if(I.shiftKey&&I.ctrlKey){H=true;}switch(I.keyCode){case 84:if(I.shiftKey&&I.ctrlKey){this.toolbar._titlebar.firstChild.focus();A.stopEvent(I);H=false;}break;case 27:if(I.shiftKey){this.afterElement.focus();A.stopEvent(I);G=false;}break;case 219:J="justifyleft";break;case 220:J="justifycenter";break;case 221:J="justifyright";break;case 76:if(this._hasSelection()){if(I.shiftKey&&I.ctrlKey){this.execCommand("createlink","");this.toolbar.fireEvent("createlinkClick",{type:"createlinkClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});H=false;}}break;case 65:if(I.metaKey&&this.browser.webkit){A.stopEvent(I);this._getSelection().setBaseAndExtent(this._getDoc().body,1,this._getDoc().body,this._getDoc().body.innerHTML.length);}break;case 66:J="bold";break;case 73:J="italic";break;case 85:J="underline";break;case 9:if(this.browser.safari){this._getDoc().execCommand("inserttext",false,"\t");A.stopEvent(I);}break;case 13:if(this.browser.ie){var K=this._getRange();var F=this._getSelectedElement();if(!this._isElement(F,"li")){if(K){K.pasteHTML("<br>");K.collapse(false);K.select();}A.stopEvent(I);}}}if(H&&J){this.execCommand(J,null);A.stopEvent(I);this.nodeChange();}this.fireEvent("editorKeyDown",{type:"editorKeyDown",target:this,ev:I});},nodeChange:function(G){var H=parseInt(this.get("nodeChangeThreshold"),10);var N=Math.round(new Date().getTime()/1000);if(G===true){this._lastNodeChange=0;}if((this._lastNodeChange+H)<N){var Q=this;if(this._fixNodesTimer===null){this._fixNodesTimer=window.setTimeout(function(){Q._fixNodes.call(Q);Q._fixNodesTimer=null;},0);}}this._lastNodeChange=N;if(this.currentEvent){this._lastNodeChangeEvent=this.currentEvent.type;}var Z=this.fireEvent("beforeNodeChange",{type:"beforeNodeChange",target:this});if(Z===false){return false;}if(this.get("dompath")){this._writeDomPath();}if(!this.get("disabled")){if(this.STOP_NODE_CHANGE){this.STOP_NODE_CHANGE=false;return false;}else{var T=this._getSelection(),P=this._getRange(),F=this._getSelectedElement(),L=this.toolbar.getButtonByValue("fontname"),K=this.toolbar.getButtonByValue("fontsize");var M={};if(this._lastButton){M[this._lastButton.id]=true;}if(!this._isElement(F,"body")){if(L){M[L.get("id")]=true;}if(K){M[K.get("id")]=true;}}this.toolbar.resetAllButtons(M);for(var a=0;a<this._disabled.length;a++){var O=this.toolbar.getButtonByValue(this._disabled[a]);if(O&&O.get){if(this._lastButton&&(O.get("id")===this._lastButton.id)){}else{if(!this._hasSelection()){switch(this._disabled[a]){case"fontname":case"fontsize":break;default:this.toolbar.disableButton(O);}}else{if(!this._alwaysDisabled[this._disabled[a]]){this.toolbar.enableButton(O);}}if(!this._alwaysEnabled[this._disabled[a]]){this.toolbar.deselectButton(O);}}}}var R=this._getDomPath();var S=null,b=null,W=null;for(var X=0;X<R.length;X++){b=R[X].tagName.toLowerCase();if(R[X].getAttribute("tag")){b=R[X].getAttribute("tag").toLowerCase();}W=this._tag2cmd[b];if(W===undefined){W=[];}if(!D.isArray(W)){W=[W];}if(R[X].style.fontWeight.toLowerCase()=="bold"){W[W.length]="bold";}if(R[X].style.fontStyle.toLowerCase()=="italic"){W[W.length]="italic";}if(R[X].style.textDecoration.toLowerCase()=="underline"){W[W.length]="underline";}if(W.length>0){for(var V=0;V<W.length;V++){this.toolbar.selectButton(W[V]);this.toolbar.enableButton(W[V]);}}switch(R[X].style.textAlign.toLowerCase()){case"left":case"right":case"center":case"justify":var U=R[X].style.textAlign.toLowerCase();
if(R[X].style.textAlign.toLowerCase()=="justify"){U="full";}this.toolbar.selectButton("justify"+U);this.toolbar.enableButton("justify"+U);break;}}if(L){var Y=L._configs.label._initialConfig.value;L.set("label","<span class=\"yui-toolbar-fontname-"+E(Y)+"\">"+Y+"</span>");this._updateMenuChecked("fontname",Y);}if(K){K.set("label",K._configs.label._initialConfig.value);}var J=this.toolbar.getButtonByValue("heading");if(J){J.set("label",J._configs.label._initialConfig.value);this._updateMenuChecked("heading","none");}var I=this.toolbar.getButtonByValue("insertimage");if(I&&this.currentWindow&&(this.currentWindow.name=="insertimage")){this.toolbar.disableButton(I);}}}this.fireEvent("afterNodeChange",{type:"afterNodeChange",target:this});},_updateMenuChecked:function(H,I,K){if(!K){K=this.toolbar;}var J=K.getButtonByValue(H);var G=J.getMenu().getItems();if(G.length===0){J.getMenu()._onBeforeShow();G=J.getMenu().getItems();}for(var F=0;F<G.length;F++){G[F].cfg.setProperty("checked",false);if(G[F].value==I){G[F].cfg.setProperty("checked",true);}}},_handleToolbarClick:function(G){var I="";var J="";var H=G.button.value;if(G.button.menucmd){I=H;H=G.button.menucmd;}this._lastButton=G.button;if(this.STOP_EXEC_COMMAND){this.STOP_EXEC_COMMAND=false;return false;}else{this.execCommand(H,I);if(!this.browser.webkit){var F=this;setTimeout(function(){F._focusWindow.call(F);},5);}}A.stopEvent(G);},_setupAfterElement:function(){if(!this.afterElement){this.afterElement=document.createElement("h2");this.afterElement.className="yui-editor-skipheader";this.afterElement.tabIndex="-1";this.afterElement.innerHTML=this.STR_LEAVE_EDITOR;this.get("element_cont").get("firstChild").appendChild(this.afterElement);}},EDITOR_PANEL_ID:"yui-editor-panel",SEP_DOMPATH:"<",STR_LEAVE_EDITOR:"You have left the Rich Text Editor.",STR_BEFORE_EDITOR:"This text field can contain stylized text and graphics. To cycle through all formatting options, use the keyboard shortcut Control + Shift + T to place focus on the toolbar and navigate between option heading names. <h4>Common formatting keyboard shortcuts:</h4><ul><li>Control Shift B sets text to bold</li> <li>Control Shift I sets text to italic</li> <li>Control Shift U underlines text</li> <li>Control Shift [ aligns text left</li> <li>Control Shift | centers text</li> <li>Control Shift ] aligns text right</li> <li>Control Shift L adds an HTML link</li> <li>To exit this text editor use the keyboard shortcut Control + Shift + ESC.</li></ul>",STR_CLOSE_WINDOW:"Close Window",STR_CLOSE_WINDOW_NOTE:"To close this window use the Control + Shift + W key",STR_TITLE:"Rich Text Area.",STR_IMAGE_HERE:"Image Url Here",STR_IMAGE_PROP_TITLE:"Image Options",STR_IMAGE_URL:"Image Url",STR_IMAGE_TITLE:"Description",STR_IMAGE_SIZE:"Size",STR_IMAGE_ORIG_SIZE:"Original Size",STR_IMAGE_COPY:"<span class=\"tip\"><span class=\"icon icon-info\"></span><strong>Note:</strong>To move this image just highlight it, cut, and paste where ever you'd like.</span>",STR_IMAGE_PADDING:"Padding",STR_IMAGE_BORDER:"Border",STR_IMAGE_TEXTFLOW:"Text Flow",STR_LOCAL_FILE_WARNING:"<span class=\"tip\"><span class=\"icon icon-warn\"></span><strong>Note:</strong>This image/link points to a file on your computer and will not be accessible to others on the internet.</span>",STR_LINK_PROP_TITLE:"Link Options",STR_LINK_PROP_REMOVE:"Remove link from text",STR_LINK_URL:"Link URL",STR_LINK_NEW_WINDOW:"Open in a new window.",STR_LINK_TITLE:"Description",STOP_EXEC_COMMAND:false,STOP_NODE_CHANGE:false,CLASS_HIDDEN:"hidden",CLASS_LOCAL_FILE:"warning-localfile",CLASS_CONTAINER:"yui-editor-container",CLASS_EDITABLE:"yui-editor-editable",CLASS_EDITABLE_CONT:"yui-editor-editable-container",CLASS_PREFIX:"yui-editor",browser:function(){var F=YAHOO.env.ua;if(F.webkit>420){F.webkit3=F.webkit;}else{F.webkit3=0;}return F;}(),init:function(G,F){YAHOO.widget.Editor.superclass.init.call(this,G,F);YAHOO.widget.EditorInfo._instances[this.get("id")]=this;this.on("contentReady",function(){this.DOMReady=true;this.fireQueue();},this,true);},initAttributes:function(F){YAHOO.widget.Editor.superclass.initAttributes.call(this,F);var G=this;this.setAttributeConfig("iframe",{value:null});this.setAttributeConfig("textarea",{value:null,writeOnce:true});this.setAttributeConfig("nodeChangeThreshold",{value:F.nodeChangeThreshold||3,validator:YAHOO.lang.isNumber});this.setAttributeConfig("element_cont",{value:F.element_cont});this.setAttributeConfig("editor_wrapper",{value:F.editor_wrapper||null,writeOnce:true});this.setAttributeConfig("height",{value:F.height||C.getStyle(G.get("element"),"height"),method:function(H){if(this._rendered){if(this.get("animate")){var I=new YAHOO.util.Anim(this.get("iframe").get("parentNode"),{height:{to:parseInt(H,10)}},0.5);I.animate();}else{C.setStyle(this.get("iframe").get("parentNode"),"height",H);}}}});this.setAttributeConfig("width",{value:F.width||C.getStyle(this.get("element"),"width"),method:function(H){if(this._rendered){if(this.get("animate")){var I=new YAHOO.util.Anim(this.get("element_cont").get("element"),{width:{to:parseInt(H,10)}},0.5);I.animate();}else{this.get("element_cont").setStyle("width",H);}}}});this.setAttributeConfig("blankimage",{value:F.blankimage||this._getBlankImage()});this.setAttributeConfig("hiddencss",{value:F.hiddencss||".hidden font, .hidden strong, .hidden b, .hidden em, .hidden i, .hidden u, .hidden div,.hidden p,.hidden span,.hidden img, .hidden ul, .hidden ol, .hidden li, .hidden table { border: 1px dotted #ccc; } .hidden .yui-non { border: none; } .hidden img { padding: 2px; }",writeOnce:true});this.setAttributeConfig("css",{value:F.css||"html { height: 95%; } body { height: 100%; padding: 7px; background-color: #fff; font:13px/1.22 arial,helvetica,clean,sans-serif;*font-size:small;*font:x-small; } a { color: blue; text-decoration: underline; cursor: pointer; } .warning-localfile { border-bottom: 1px dashed red !important; } .yui-busy { cursor: wait !important; } img.selected { border: 2px dotted #808080; } img { cursor: pointer !important; border: none; }",writeOnce:true});
this.setAttributeConfig("html",{value:F.html||"<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01//EN\" \"http://www.w3.org/TR/html4/strict.dtd\"><html><head><title>{TITLE}</title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /><base href=\""+this._baseHREF+"\"><style>{CSS}</style><style>{HIDDEN_CSS}</style></head><body onload=\"document.body._rteLoaded = true;\">{CONTENT}</body></html>",writeOnce:true});this.setAttributeConfig("handleSubmit",{value:false,writeOnce:true,method:function(H){if(H){var J=this.get("element");if(J.form){var I=function(K){A.stopEvent(K);this.saveHTML();window.setTimeout(function(){YAHOO.util.Event.removeListener(J.form,"submit",I);J.form.submit();},200);};A.on(J.form,"submit",I,this,true);}}}});this.setAttributeConfig("disabled",{value:false,method:function(H){if(H){if(!this._mask){this._setDesignMode("off");this.toolbar.set("disabled",true);this._mask=document.createElement("DIV");C.setStyle(this._mask,"height","100%");C.setStyle(this._mask,"width","100%");C.setStyle(this._mask,"position","absolute");C.setStyle(this._mask,"top","0");C.setStyle(this._mask,"left","0");C.setStyle(this._mask,"opacity",".5");C.addClass(this._mask,"yui-editor-masked");this.get("iframe").get("parentNode").appendChild(this._mask);}}else{if(this._mask){this._mask.parentNode.removeChild(this._mask);this._mask=null;this.toolbar.set("disabled",false);this._setDesignMode("on");this._focusWindow();}}}});this.setAttributeConfig("toolbar_cont",{value:null,writeOnce:true});this.setAttributeConfig("toolbar",{value:F.toolbar||{collapse:true,titlebar:"Text Editing Tools",draggable:false,buttons:[{group:"fontstyle",label:"Font Name and Size",buttons:[{type:"select",label:"Arial",value:"fontname",disabled:true,menu:[{text:"Arial",checked:true},{text:"Arial Black"},{text:"Comic Sans MS"},{text:"Courier New"},{text:"Lucida Console"},{text:"Tahoma"},{text:"Times New Roman"},{text:"Trebuchet MS"},{text:"Verdana"}]},{type:"spin",label:"13",value:"fontsize",range:[9,75],disabled:true}]},{type:"separator"},{group:"textstyle",label:"Font Style",buttons:[{type:"push",label:"Bold CTRL + SHIFT + B",value:"bold"},{type:"push",label:"Italic CTRL + SHIFT + I",value:"italic"},{type:"push",label:"Underline CTRL + SHIFT + U",value:"underline"},{type:"separator"},{type:"push",label:"Subscript",value:"subscript",disabled:true},{type:"push",label:"Superscript",value:"superscript",disabled:true},{type:"separator"},{type:"color",label:"Font Color",value:"forecolor",disabled:true},{type:"color",label:"Background Color",value:"backcolor",disabled:true},{type:"separator"},{type:"push",label:"Remove Formatting",value:"removeformat",disabled:true},{type:"push",label:"Show/Hide Hidden Elements",value:"hiddenelements"}]},{type:"separator"},{group:"alignment",label:"Alignment",buttons:[{type:"push",label:"Align Left CTRL + SHIFT + [",value:"justifyleft"},{type:"push",label:"Align Center CTRL + SHIFT + |",value:"justifycenter"},{type:"push",label:"Align Right CTRL + SHIFT + ]",value:"justifyright"},{type:"push",label:"Justify",value:"justifyfull"}]},{type:"separator"},{group:"parastyle",label:"Paragraph Style",buttons:[{type:"select",label:"Normal",value:"heading",disabled:true,menu:[{text:"Normal",value:"none",checked:true},{text:"Header 1",value:"h1"},{text:"Header 2",value:"h2"},{text:"Header 3",value:"h3"},{text:"Header 4",value:"h4"},{text:"Header 5",value:"h5"},{text:"Header 6",value:"h6"}]}]},{type:"separator"},{group:"indentlist",label:"Indenting and Lists",buttons:[{type:"push",label:"Indent",value:"indent",disabled:true},{type:"push",label:"Outdent",value:"outdent",disabled:true},{type:"push",label:"Create an Unordered List",value:"insertunorderedlist"},{type:"push",label:"Create an Ordered List",value:"insertorderedlist"}]},{type:"separator"},{group:"insertitem",label:"Insert Item",buttons:[{type:"push",label:"HTML Link CTRL + SHIFT + L",value:"createlink",disabled:true},{type:"push",label:"Insert Image",value:"insertimage"}]}]},writeOnce:true,method:function(H){}});this.setAttributeConfig("animate",{value:false,validator:function(I){var H=true;if(!YAHOO.util.Anim){H=false;}return H;}});this.setAttributeConfig("panel",{value:null,writeOnce:true,validator:function(I){var H=true;if(!YAHOO.widget.Overlay){H=false;}return H;}});this.setAttributeConfig("localFileWarning",{value:F.locaFileWarning||true});this.setAttributeConfig("focusAtStart",{value:F.focusAtStart||false,writeOnce:true,method:function(){this.on("editorContentLoaded",function(){var H=this;setTimeout(function(){H._focusWindow.call(H,true);},400);},this,true);}});this.setAttributeConfig("dompath",{value:F.dompath||false,method:function(H){if(H&&!this.dompath){this.dompath=document.createElement("DIV");this.dompath.id=this.get("id")+"_dompath";C.addClass(this.dompath,"dompath");this.get("element_cont").get("firstChild").appendChild(this.dompath);if(this.get("iframe")){this._writeDomPath();}}else{if(!H&&this.dompath){this.dompath.parentNode.removeChild(this.dompath);this.dompath=null;}}this._setupAfterElement();}});this.setAttributeConfig("markup",{value:F.markup||"semantic",validator:function(H){switch(H.toLowerCase()){case"semantic":case"css":case"default":case"xhtml":return true;}return false;}});this.setAttributeConfig("removeLineBreaks",{value:F.removeLineBreaks||false,validator:YAHOO.lang.isBoolean});this.on("afterRender",function(){this._renderPanel();});},_getBlankImage:function(){if(!this.DOMReady){this._queue[this._queue.length]=["_getBlankImage",arguments];return"";}var F="";if(!this._blankImageLoaded){var G=document.createElement("div");G.style.position="absolute";G.style.top="-9999px";G.style.left="-9999px";G.className=this.CLASS_PREFIX+"-blankimage";document.body.appendChild(G);F=YAHOO.util.Dom.getStyle(G,"background-image");F=F.replace("url(","").replace(")","").replace(/"/g,"");this.set("blankimage",F);this._blankImageLoaded=true;}else{F=this.get("blankimage");}return F;},_handleFontSize:function(H){var F=this.toolbar.getButtonById(H.button.id);
var G=F.get("label")+"px";this.execCommand("fontsize",G);this.STOP_EXEC_COMMAND=true;},_handleColorPicker:function(H){var G=H.button;var F="#"+H.color;if((G=="forecolor")||(G=="backcolor")){this.execCommand(G,F);}},_handleAlign:function(J){var G=this.toolbar.getButtonById(J.button.id);var I=null;for(var F=0;F<J.button.menu.length;F++){if(J.button.menu[F].value==J.button.value){I=J.button.menu[F].value;}}var H=this._getSelection();this.execCommand(I,H);this.STOP_EXEC_COMMAND=true;},_handleAfterNodeChange:function(){var R=this._getDomPath(),M=null,I=null,N=null,G=false;var K=this.toolbar.getButtonByValue("fontname");var L=this.toolbar.getButtonByValue("fontsize");var F=this.toolbar.getButtonByValue("heading");for(var H=0;H<R.length;H++){M=R[H];var Q=M.tagName.toLowerCase();if(M.getAttribute("tag")){Q=M.getAttribute("tag");}I=M.getAttribute("face");if(C.getStyle(M,"font-family")){I=C.getStyle(M,"font-family");}if(Q.substring(0,1)=="h"){if(F){for(var J=0;J<F._configs.menu.value.length;J++){if(F._configs.menu.value[J].value.toLowerCase()==Q){F.set("label",F._configs.menu.value[J].text);}}this._updateMenuChecked("heading",Q);}}}if(K){for(var P=0;P<K._configs.menu.value.length;P++){if(I&&K._configs.menu.value[P].text.toLowerCase()==I.toLowerCase()){G=true;I=K._configs.menu.value[P].text;}}if(!G){I=K._configs.label._initialConfig.value;}var O="<span class=\"yui-toolbar-fontname-"+E(I)+"\">"+I+"</span>";if(K.get("label")!=O){K.set("label",O);this._updateMenuChecked("fontname",I);}}if(L){N=parseInt(C.getStyle(M,"fontSize"),10);if((N===null)||isNaN(N)){N=L._configs.label._initialConfig.value;}L.set("label",""+N);}if(!this._isElement(M,"body")&&!this._isElement(M,"img")){this.toolbar.enableButton(K);this.toolbar.enableButton(L);this.toolbar.enableButton("forecolor");this.toolbar.enableButton("backcolor");}if(this._isElement(M,"img")){this.toolbar.enableButton("createlink");}if(this._isElement(M,"blockquote")){this.toolbar.selectButton("indent");this.toolbar.disableButton("indent");this.toolbar.enableButton("outdent");}this._lastButton=null;},_setBusy:function(F){},_handleInsertImageClick:function(){this._setBusy();this.on("afterExecCommand",function(){var I=this.currentElement[0],S=null,P="",e="",f="",O="",b="",V=75,Y=75,U=0,Q=0,N=0,W=false,M=new YAHOO.widget.EditorWindow("insertimage",{width:"415px"});if(!I){I=this._getSelectedElement();}if(I){if(I.getAttribute("src")){O=I.getAttribute("src",2);if(O.indexOf(this.get("blankimage"))!=-1){O=this.STR_IMAGE_HERE;W=true;}}if(I.getAttribute("alt",2)){f=I.getAttribute("alt",2);}if(I.getAttribute("title",2)){f=I.getAttribute("title",2);}if(I.parentNode&&this._isElement(I.parentNode,"a")){P=I.parentNode.getAttribute("href");if(I.parentNode.getAttribute("target")!==null){e=I.parentNode.getAttribute("target");}}V=parseInt(I.height,10);Y=parseInt(I.width,10);if(I.style.height){V=parseInt(I.style.height,10);}if(I.style.width){Y=parseInt(I.style.width,10);}if(I.style.margin){U=parseInt(I.style.margin,10);}if(!I._height){I._height=V;}if(!I._width){I._width=Y;}Q=I._height;N=I._width;}var Z="<label for=\"insertimage_url\"><strong>"+this.STR_IMAGE_URL+":</strong> <input type=\"text\" id=\"insertimage_url\" value=\""+O+"\" size=\"40\"></label>";S=document.createElement("div");S.innerHTML=Z;var K=document.createElement("div");K.id="img_toolbar";S.appendChild(K);var F="<label for=\"insertimage_title\"><strong>"+this.STR_IMAGE_TITLE+":</strong> <input type=\"text\" id=\"insertimage_title\" value=\""+f+"\" size=\"40\"></label>";F+="<label for=\"insertimage_link\"><strong>"+this.STR_LINK_URL+":</strong> <input type=\"text\" name=\"insertimage_link\" id=\"insertimage_link\" value=\""+P+"\"></label>";F+="<label for=\"insertimage_target\"><strong>&nbsp;</strong><input type=\"checkbox\" name=\"insertimage_target_\" id=\"insertimage_target\" value=\"_blank\""+((e)?" checked":"")+"> "+this.STR_LINK_NEW_WINDOW+"</label>";var T=document.createElement("div");T.innerHTML=F;S.appendChild(T);M.cache=S;var H=new YAHOO.widget.Toolbar(K,{buttons:[{group:"textflow",label:this.STR_IMAGE_TEXTFLOW+":",buttons:[{type:"push",label:"Left",value:"left"},{type:"push",label:"Inline",value:"inline"},{type:"push",label:"Block",value:"block"},{type:"push",label:"Right",value:"right"}]},{type:"separator"},{group:"padding",label:this.STR_IMAGE_PADDING+":",buttons:[{type:"spin",label:""+U,value:"padding",range:[0,50]}]},{type:"separator"},{group:"border",label:this.STR_IMAGE_BORDER+":",buttons:[{type:"select",label:"Border Size",value:"bordersize",menu:[{text:"none",value:"0",checked:true},{text:" ",value:"1"},{text:" ",value:"2"},{text:" ",value:"3"},{text:" ",value:"4"},{text:" ",value:"5"}]},{type:"select",label:"Border Type",value:"bordertype",disabled:true,menu:[{text:" ",value:"solid",checked:true},{text:" ",value:"dashed"},{text:" ",value:"dotted"}]},{type:"color",label:"Border Color",value:"bordercolor",disabled:true}]}]});var G="0";var X="solid";if(I.style.borderLeftWidth){G=parseInt(I.style.borderLeftWidth,10);}if(I.style.borderLeftStyle){X=I.style.borderLeftStyle;}var d=H.getButtonByValue("bordersize");var a=((parseInt(G,10)>0)?"":"none");d.set("label","<span class=\"yui-toolbar-bordersize-"+G+"\">"+a+"</span>");this._updateMenuChecked("bordersize",G,H);var R=H.getButtonByValue("bordertype");R.set("label","<span class=\"yui-toolbar-bordertype-"+X+"\"></span>");this._updateMenuChecked("bordertype",X,H);if(parseInt(G,10)>0){H.enableButton(R);H.enableButton(d);}var J=H.get("cont");var c=document.createElement("div");c.className="yui-toolbar-group yui-toolbar-group-height-width height-width";c.innerHTML="<h3>"+this.STR_IMAGE_SIZE+":</h3>";var L="";if((V!=Q)||(Y!=N)){L="<span class=\"info\">"+this.STR_IMAGE_ORIG_SIZE+"<br>"+N+" x "+Q+"</span>";}c.innerHTML+="<span><input type=\"text\" size=\"3\" value=\""+Y+"\" id=\"insertimage_width\"> x <input type=\"text\" size=\"3\" value=\""+V+"\" id=\"insertimage_height\"></span>"+L;J.insertBefore(c,J.firstChild);A.onAvailable("insertimage_width",function(){A.on("insertimage_width","blur",function(){var g=parseInt(C.get("insertimage_width").value,10);
if(g>5){I.style.width=g+"px";this.moveWindow();}},this,true);},this,true);A.onAvailable("insertimage_height",function(){A.on("insertimage_height","blur",function(){var g=parseInt(C.get("insertimage_height").value,10);if(g>5){I.style.height=g+"px";this.moveWindow();}},this,true);},this,true);if((I.align=="right")||(I.align=="left")){H.selectButton(I.align);}else{if(I.style.display=="block"){H.selectButton("block");}else{H.selectButton("inline");}}if(parseInt(I.style.marginLeft,10)>0){H.getButtonByValue("padding").set("label",""+parseInt(I.style.marginLeft,10));}if(I.style.borderSize){H.selectButton("bordersize");H.selectButton(parseInt(I.style.borderSize,10));}H.on("colorPickerClicked",function(k){var h="1",j="solid",g="black";if(I.style.borderLeftWidth){h=parseInt(I.style.borderLeftWidth,10);}if(I.style.borderLeftStyle){j=I.style.borderLeftStyle;}if(I.style.borderLeftColor){g=I.style.borderLeftColor;}var i=h+"px "+j+" #"+k.color;I.style.border=i;},this.toolbar,true);H.on("buttonClick",function(m){var k=m.button.value,j="";if(m.button.menucmd){k=m.button.menucmd;}var h="1",i="solid",g="black";if(I.style.borderLeftWidth){h=parseInt(I.style.borderLeftWidth,10);}if(I.style.borderLeftStyle){i=I.style.borderLeftStyle;}if(I.style.borderLeftColor){g=I.style.borderLeftColor;}switch(k){case"bordersize":if(this.browser.webkit&&this._lastImage){C.removeClass(this._lastImage,"selected");this._lastImage=null;}j=parseInt(m.button.value,10)+"px "+i+" "+g;I.style.border=j;if(parseInt(m.button.value,10)>0){H.enableButton("bordertype");H.enableButton("bordercolor");}else{H.disableButton("bordertype");H.disableButton("bordercolor");}break;case"bordertype":if(this.browser.webkit&&this._lastImage){C.removeClass(this._lastImage,"selected");this._lastImage=null;}j=h+"px "+m.button.value+" "+g;I.style.border=j;break;case"right":case"left":H.deselectAllButtons();I.style.display="";I.align=m.button.value;break;case"inline":H.deselectAllButtons();I.style.display="";I.align="";break;case"block":H.deselectAllButtons();I.style.display="block";I.align="center";break;case"padding":var l=H.getButtonById(m.button.id);I.style.margin=l.get("label")+"px";break;}H.selectButton(m.button.value);this.moveWindow();},this,true);M.setHeader(this.STR_IMAGE_PROP_TITLE);M.setBody(S);if((this.browser.webkit&&!this.browser.webkit3)||this.browser.opera){M.setFooter(this.STR_IMAGE_COPY);}this.openWindow(M);A.onAvailable("insertimage_url",function(){this.toolbar.selectButton("insertimage");window.setTimeout(function(){YAHOO.util.Dom.get("insertimage_url").focus();if(W){YAHOO.util.Dom.get("insertimage_url").select();}},50);if(this.get("localFileWarning")){A.on("insertimage_link","blur",function(){var g=C.get("insertimage_link");if(this._isLocalFile(g.value)){C.addClass(g,"warning");this.get("panel").setFooter(this.STR_LOCAL_FILE_WARNING);}else{C.removeClass(g,"warning");this.get("panel").setFooter(" ");if((this.browser.webkit&&!this.browser.webkit3)||this.browser.opera){this.get("panel").setFooter(this.STR_IMAGE_COPY);}}},this,true);A.on("insertimage_url","blur",function(){var i=C.get("insertimage_url");if(this._isLocalFile(i.value)){C.addClass(i,"warning");this.get("panel").setFooter(this.STR_LOCAL_FILE_WARNING);}else{C.removeClass(i,"warning");this.get("panel").setFooter(" ");if((this.browser.webkit&&!this.browser.webkit3)||this.browser.opera){this.get("panel").setFooter(this.STR_IMAGE_COPY);}if(i&&i.value&&(i.value!=this.STR_IMAGE_HERE)){this.currentElement[0].setAttribute("src",i.value);var h=this,g=new Image();g.onerror=function(){i.value=h.STR_IMAGE_HERE;g.setAttribute("src",h.get("blankimage"));h.currentElement[0].setAttribute("src",h.get("blankimage"));YAHOO.util.Dom.get("insertimage_height").value=g.height;YAHOO.util.Dom.get("insertimage_width").value=g.width;};window.setTimeout(function(){YAHOO.util.Dom.get("insertimage_height").value=g.height;YAHOO.util.Dom.get("insertimage_width").value=g.width;if(h.currentElement&&h.currentElement[0]){if(!h.currentElement[0]._height){h.currentElement[0]._height=g.height;}if(!h.currentElement[0]._width){h.currentElement[0]._width=g.width;}}h.moveWindow();},200);if(i.value!=this.STR_IMAGE_HERE){g.src=i.value;}}}},this,true);}},this,true);});},_handleInsertImageWindowClose:function(){var F=C.get("insertimage_url");var M=C.get("insertimage_title");var J=C.get("insertimage_link");var K=C.get("insertimage_target");var I=this.currentElement[0];if(F&&F.value&&(F.value!=this.STR_IMAGE_HERE)){I.setAttribute("src",F.value);I.setAttribute("title",M.value);I.setAttribute("alt",M.value);var H=I.parentNode;if(J.value){var L=J.value;if((L.indexOf("://")==-1)&&(L.substring(0,1)!="/")&&(L.substring(0,6).toLowerCase()!="mailto")){if((L.indexOf("@")!=-1)&&(L.substring(0,6).toLowerCase()!="mailto")){L="mailto:"+L;}else{L="http://"+L;}}if(H&&this._isElement(H,"a")){H.setAttribute("href",L);if(K.checked){H.setAttribute("target",K.value);}else{H.setAttribute("target","");}}else{var G=this._getDoc().createElement("a");G.setAttribute("href",L);if(K.checked){G.setAttribute("target",K.value);}else{G.setAttribute("target","");}I.parentNode.replaceChild(G,I);G.appendChild(I);}}else{if(H&&this._isElement(H,"a")){H.parentNode.replaceChild(I,H);}}}else{I.parentNode.removeChild(I);}this.currentElement=[];this.nodeChange();},_isLocalFile:function(F){if((F!=="")&&((F.indexOf("file:/")!=-1)||(F.indexOf(":\\")!=-1))){return true;}return false;},_handleCreateLinkClick:function(){var F=this._getSelectedElement();if(this._isElement(F,"img")){this.STOP_EXEC_COMMAND=true;this.currentElement[0]=F;this.toolbar.fireEvent("insertimageClick",{type:"insertimageClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});return false;}this.on("afterExecCommand",function(){var M=new YAHOO.widget.EditorWindow("createlink",{width:"350px"});var J=this.currentElement[0],I="",P="",N="",K=false;if(J){if(J.getAttribute("href")!==null){I=J.getAttribute("href");if(this._isLocalFile(I)){M.setFooter(this.STR_LOCAL_FILE_WARNING);
K=true;}else{M.setFooter(" ");}}if(J.getAttribute("title")!==null){P=J.getAttribute("title");}if(J.getAttribute("target")!==null){N=J.getAttribute("target");}}var O="<label for=\"createlink_url\"><strong>"+this.STR_LINK_URL+":</strong> <input type=\"text\" name=\"createlink_url\" id=\"createlink_url\" value=\""+I+"\""+((K)?" class=\"warning\"":"")+"></label>";O+="<label for=\"createlink_target\"><strong>&nbsp;</strong><input type=\"checkbox\" name=\"createlink_target_\" id=\"createlink_target\" value=\"_blank\""+((N)?" checked":"")+"> "+this.STR_LINK_NEW_WINDOW+"</label>";O+="<label for=\"createlink_title\"><strong>"+this.STR_LINK_TITLE+":</strong> <input type=\"text\" name=\"createlink_title\" id=\"createlink_title\" value=\""+P+"\"></label>";var L=document.createElement("div");L.innerHTML=O;var H=document.createElement("div");H.className="removeLink";var G=document.createElement("a");G.href="#";G.innerHTML=this.STR_LINK_PROP_REMOVE;G.title=this.STR_LINK_PROP_REMOVE;A.on(G,"click",function(Q){A.stopEvent(Q);this.execCommand("unlink");this.closeWindow();},this,true);H.appendChild(G);L.appendChild(H);M.setHeader(this.STR_LINK_PROP_TITLE);M.setBody(L);A.onAvailable("createlink_url",function(){window.setTimeout(function(){try{YAHOO.util.Dom.get("createlink_url").focus();}catch(Q){}},50);A.on("createlink_url","blur",function(){var Q=C.get("createlink_url");if(this._isLocalFile(Q.value)){C.addClass(Q,"warning");this.get("panel").setFooter(this.STR_LOCAL_FILE_WARNING);}else{C.removeClass(Q,"warning");this.get("panel").setFooter(" ");}},this,true);},this,true);this.openWindow(M);});},_handleCreateLinkWindowClose:function(){var H=C.get("createlink_url"),J=C.get("createlink_target"),L=C.get("createlink_title"),I=this.currentElement[0],F=I;if(H&&H.value){var K=H.value;if((K.indexOf("://")==-1)&&(K.substring(0,1)!="/")&&(K.substring(0,6).toLowerCase()!="mailto")){if((K.indexOf("@")!=-1)&&(K.substring(0,6).toLowerCase()!="mailto")){K="mailto:"+K;}else{K="http://"+K;}}I.setAttribute("href",K);if(J.checked){I.setAttribute("target",J.value);}else{I.setAttribute("target","");}I.setAttribute("title",((L.value)?L.value:""));}else{var G=this._getDoc().createElement("span");G.innerHTML=I.innerHTML;C.addClass(G,"yui-non");I.parentNode.replaceChild(G,I);}this.nodeChange();this.currentElement=[];},render:function(){if(this._rendered){return false;}if(!this.DOMReady){this._queue[this._queue.length]=["render",arguments];return false;}this._setBusy();this._rendered=true;var F=this;this.set("textarea",this.get("element"));this.get("element_cont").setStyle("display","none");this.get("element_cont").addClass(this.CLASS_CONTAINER);this.set("iframe",this._createIframe());window.setTimeout(function(){F._setInitialContent.call(F);},10);this.get("editor_wrapper").appendChild(this.get("iframe").get("element"));C.addClass(this.get("iframe").get("parentNode"),this.CLASS_EDITABLE_CONT);this.get("iframe").addClass(this.CLASS_EDITABLE);var G=this.get("toolbar");G.disabled=true;this.toolbar=new B(this.get("toolbar_cont"),G);this.fireEvent("toolbarLoaded",{type:"toolbarLoaded",target:this.toolbar});this.toolbar.on("toolbarCollapsed",function(){if(this.currentWindow){this.moveWindow();}},this,true);this.toolbar.on("toolbarExpanded",function(){if(this.currentWindow){this.moveWindow();}},this,true);this.toolbar.on("fontsizeClick",function(H){this._handleFontSize(H);},this,true);this.toolbar.on("colorPickerClicked",function(H){this._handleColorPicker(H);},this,true);this.toolbar.on("alignClick",function(H){this._handleAlign(H);},this,true);this.on("afterNodeChange",function(){this._handleAfterNodeChange();},this,true);this.toolbar.on("insertimageClick",function(){this._handleInsertImageClick();},this,true);this.on("windowinsertimageClose",function(){this._handleInsertImageWindowClose();},this,true);this.toolbar.on("createlinkClick",function(){this._handleCreateLinkClick();},this,true);this.on("windowcreatelinkClose",function(){this._handleCreateLinkWindowClose();},this,true);this.get("parentNode").replaceChild(this.get("element_cont").get("element"),this.get("element"));if(!this.beforeElement){this.beforeElement=document.createElement("h2");this.beforeElement.className="yui-editor-skipheader";this.beforeElement.tabIndex="-1";this.beforeElement.innerHTML=this.STR_BEFORE_EDITOR;this.get("element_cont").get("firstChild").insertBefore(this.beforeElement,this.toolbar.get("nextSibling"));}this.setStyle("visibility","hidden");this.setStyle("position","absolute");this.setStyle("top","-9999px");this.setStyle("left","-9999px");this.get("element_cont").appendChild(this.get("element"));this.get("element_cont").setStyle("display","block");this.get("element_cont").setStyle("width",this.get("width"));C.setStyle(this.get("iframe").get("parentNode"),"height",this.get("height"));this.get("iframe").setStyle("width","100%");this.get("iframe").setStyle("height","100%");this.fireEvent("afterRender",{type:"afterRender",target:this});},execCommand:function(d,Y){var Z=this.fireEvent("beforeExecCommand",{type:"beforeExecCommand",target:this,args:arguments});if((Z===false)||(this.STOP_EXEC_COMMAND)){this.STOP_EXEC_COMMAND=false;return false;}this._setMarkupType(d);if(this.browser.ie){this._getWindow().focus();}var c=true,q=null,G=null,r="",a="",N=null,o=this._getSelection(),H=this._getRange(),S=this._getSelectedElement();if(S){o=S;}switch(d.toLowerCase()){case"heading":if(this.browser.ie){d="formatblock";}var l=0;if(Y=="none"){if((o&&o.tagName&&(o.tagName.toLowerCase().substring(0,1)=="h"))||(o&&o.parentNode&&o.parentNode.tagName&&(o.parentNode.tagName.toLowerCase().substring(0,1)=="h"))){if(o.parentNode.tagName.toLowerCase().substring(0,1)=="h"){if(!this._isElement(o.parentNode,"html")){o=o.parentNode;}}if(this._isElement(o,"body")){return false;}for(l=0;l<this.currentElement.length;l++){if(this._isElement(this.currentElement[l],"h1")||this._isElement(this.currentElement[l],"h2")||this._isElement(this.currentElement[l],"h3")||this._isElement(this.currentElement[l],"h4")||this._isElement(this.currentElement[l],"h5")||this._isElement(this.currentElement[l],"h6")){G=this._swapEl(this.currentElement[l],"span",function(e){e.className="yui-non";
e.innerHTML=e.innerHTML.replace(new RegExp("<span class=\"yui-non\">(.*?)</span>","gi"),"$1");});this.currentElement[l]=G;}if(this.currentElement[l].nextSibling&&!this._isElement(this.currentElement[l].nextSibling,"br")){var P=this._getDoc().createElement("br");this.currentElement[l].parentNode.insertBefore(P,this.currentElement[l].nextSibling);}}}c=false;}else{if(this._isElement(S,"h1")||this._isElement(S,"h2")||this._isElement(S,"h3")||this._isElement(S,"h4")||this._isElement(S,"h5")||this._isElement(S,"h6")){G=this._swapEl(S,Y);this._selectNode(G);this.currentElement[0]=G;}else{this._createCurrentElement(Y);this._selectNode(this.currentElement[0]);for(l=0;l<this.currentElement.length;l++){if(this.currentElement[l].nextSibling&&this._isElement(this.currentElement[l].nextSibling,"br")){this.currentElement[l].nextSibling.parentNode.removeChild(this.currentElement[l].nextSibling);}}}c=false;}break;case"backcolor":if(this.browser.gecko||this.browser.opera){this._setEditorStyle(true);d="hilitecolor";}G=this._getSelectedElement();if(this.browser.opera){if(!this._isElement(G,"body")&&C.getStyle(G,"background-color")){C.setStyle(G,"background-color",Y);}else{this._createCurrentElement("span",{backgroundColor:Y});}c=false;}else{if(!this._hasSelection()){if(G!==this._getDoc().body){C.setStyle(G,"background-color",Y);c=false;}}}break;case"forecolor":G=this._getSelectedElement();if((G!==this._getDoc().body)&&(!this._hasSelection())){C.setStyle(G,"color",Y);c=false;}break;case"hiddenelements":this._showHidden();c=false;break;case"unlink":G=this._swapEl(this.currentElement[0],"span",function(e){e.className="yui-non";});c=false;break;case"createlink":G=this._getSelectedElement();var M=null;if(!this._isElement(G,"a")){this._createCurrentElement("a");M=this._swapEl(this.currentElement[0],"a");this.currentElement[0]=M;}else{this.currentElement[0]=G;}c=false;break;case"insertimage":if(Y===""){Y=this.get("blankimage");}G=this._getSelectedElement();if(this._isElement(G,"img")){this.currentElement[0]=G;c=false;}else{if(this._getDoc().queryCommandEnabled(d)){this._getDoc().execCommand("insertimage",false,Y);var V=this._getDoc().getElementsByTagName("img");for(var k=0;k<V.length;k++){if(!YAHOO.util.Dom.hasClass(V[k],"yui-img")){YAHOO.util.Dom.addClass(V[k],"yui-img");this.currentElement[0]=V[k];}}c=false;}else{var I=null;if(G==this._getDoc().body){I=this._getDoc().createElement("img");I.setAttribute("src",Y);YAHOO.util.Dom.addClass(I,"yui-img");this._getDoc().body.appendChild(I);}else{this._createCurrentElement("img");I=this._getDoc().createElement("img");I.setAttribute("src",Y);YAHOO.util.Dom.addClass(I,"yui-img");this.currentElement[0].parentNode.replaceChild(I,this.currentElement[0]);}this.currentElement[0]=I;c=false;}}break;case"inserthtml":if(this.browser.webkit&&!this._getDoc().queryCommandEnabled(d)){this._createCurrentElement("img");N=this._getDoc().createElement("span");N.innerHTML=Y;this.currentElement[0].parentNode.replaceChild(N,this.currentElement[0]);c=false;}else{if(this.browser.ie){H=this._getRange();if(H.item){H.item(0).outerHTML=Y;}else{H.pasteHTML(Y);}c=false;}}break;case"removeformat":if(this.browser.webkit&&!this._getDoc().queryCommandEnabled(d)){this._createCurrentElement("span");YAHOO.util.Dom.addClass(this.currentElement[0],"yui-non");var X=/<\S[^><]*>/g;a=this.currentElement[0].innerHTML.replace(X,"");var b=this._getDoc().createTextNode(a);this.currentElement[0].parentNode.parentNode.replaceChild(b,this.currentElement[0].parentNode);c=false;}break;case"superscript":case"subscript":if(this.browser.webkit){r=d.toLowerCase().substring(0,3);if(this._isElement(S,r)){N=this._swapEl(this.currentElement[0],"span",function(e){e.className="yui-non";});this._selectNode(N);}else{this._createCurrentElement(r);var R=this._swapEl(this.currentElement[0],r);this._selectNode(R);this.currentElement[0]=R;}c=false;}break;case"formatblock":Y="blockquote";if(this.browser.webkit){this._createCurrentElement("blockquote");if(YAHOO.util.Dom.hasClass(this.currentElement[0].parentNode,"yui-tag-blockquote")){N=this._getDoc().createElement("span");N.innerHTML=this.currentElement[0].innerHTML;YAHOO.util.Dom.addClass(N,"yui-non");this.currentElement[0].parentNode.parentNode.replaceChild(N,this.currentElement[0].parentNode);}c=false;}else{var g=A.getTarget(this.currentEvent);if(this._isElement(g,"blockquote")){N=this._getDoc().createElement("span");N.innerHTML=g.innerHTML;YAHOO.util.Dom.addClass(N,"yui-non");g.parentNode.replaceChild(N,g);c=false;}}break;case"indent":case"outdent":if(this.browser.webkit||this.browser.ie||this.browser.gecko){q=this._getSelectedElement();var Q=null;if(this._isElement(q,"blockquote")){if(d=="indent"){Q=this._getDoc().createElement("blockquote");Q.innerHTML=q.innerHTML;q.innerHTML="";q.appendChild(Q);this._selectNode(Q);}else{var U=q.parentNode;if(this._isElement(q.parentNode,"blockquote")){U.innerHTML=q.innerHTML;this._selectNode(U);}else{N=this._getDoc().createElement("span");N.innerHTML=q.innerHTML;YAHOO.util.Dom.addClass(N,"yui-non");U.replaceChild(N,q);this._selectNode(N);}}}else{if(d=="indent"){this._createCurrentElement("blockquote");Q=this._getDoc().createElement("blockquote");Q.innerHTML=this.currentElement[0].innerHTML;this.currentElement[0].parentNode.replaceChild(Q,this.currentElement[0]);this.currentElement[0]=Q;this._selectNode(Q);}else{}}c=false;}else{Y="blockquote";}break;case"insertorderedlist":case"insertunorderedlist":r=((d.toLowerCase()=="insertorderedlist")?"ol":"ul");if((this.browser.webkit&&!this._getDoc().queryCommandEnabled(d))){var n=null;q=this._getSelectedElement();var T=0;if(this._isElement(q,"li")&&this._isElement(q.parentNode,r)){G=q.parentNode;n=this._getDoc().createElement("span");YAHOO.util.Dom.addClass(n,"yui-non");a="";var F=G.getElementsByTagName("li");for(T=0;T<F.length;T++){a+="<div>"+F[T].innerHTML+"</div>";}n.innerHTML=a;this.currentElement[0]=G;}else{this._createCurrentElement(r.toLowerCase());n=this._getDoc().createElement(r);var J=this.currentElement;
for(T=0;T<this.currentElement.length;T++){var L=this._getDoc().createElement("li");L.innerHTML=this.currentElement[T].innerHTML+"&nbsp;";n.appendChild(L);if(T>0){this.currentElement[T].parentNode.removeChild(this.currentElement[T]);}}}this.currentElement[0].parentNode.replaceChild(n,this.currentElement[0]);c=false;}else{G=this._getSelectedElement();if(this._isElement(G,"li")&&this._isElement(G.parentNode,r)||(this.browser.ie&&this._isElement(this._getRange().parentElement,"li"))){if(this.browser.ie){a="";var K=G.parentNode.getElementsByTagName("li");for(var f=0;f<K.length;f++){a+=K[f].innerHTML+"<br>";}var p=this._getDoc().createElement("span");p.innerHTML=a;G.parentNode.parentNode.replaceChild(p,G.parentNode);}else{this.nodeChange();this._getDoc().execCommand(d,"",G.parentNode);this.nodeChange();}c=false;}if(this.browser.opera){var W=this;window.setTimeout(function(){var e=W._getDoc().getElementsByTagName("li");for(var h=0;h<e.length;h++){if(e[h].innerHTML.toLowerCase()=="<br>"){e[h].parentNode.parentNode.removeChild(e[h].parentNode);}}},30);}if(this.browser.ie&&c){var O="";if(this._getRange().html){O="<li>"+this._getRange().html+"</li>";}else{O="<li>"+this._getRange().text+"</li>";}this._getRange().pasteHTML("<"+r+">"+O+"</"+r+">");c=false;}}break;case"fontname":q=this._getSelectedElement();this.currentFont=Y;if(q&&q.tagName&&!this._hasSelection()){YAHOO.util.Dom.setStyle(q,"font-family",Y);c=false;}break;case"fontsize":if((this.currentElement.length>0)&&(!this._hasSelection())){YAHOO.util.Dom.setStyle(this.currentElement,"fontSize",Y);}else{if(!this._isElement(this._getSelectedElement(),"body")){YAHOO.util.Dom.setStyle(this._getSelectedElement(),"fontSize",Y);}else{this._createCurrentElement("span",{"fontSize":Y});}}c=false;break;}if(c){try{this._getDoc().execCommand(d,false,Y);}catch(m){}}else{}this.on("afterExecCommand",function(){this.unsubscribeAll("afterExecCommand");this.nodeChange();});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});},_swapEl:function(G,F,I){var H=this._getDoc().createElement(F);H.innerHTML=G.innerHTML;if(typeof I=="function"){I.call(this,H);}G.parentNode.replaceChild(H,G);return H;},_createCurrentElement:function(H,U){H=((H)?H:"a");var Z=this._getSelection(),c=null,G=[],I=this._getDoc();if(this.currentFont){if(!U){U={};}U.fontFamily=this.currentFont;this.currentFont=null;}this.currentElement=[];var X=function(){var g=null;switch(H){case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":g=I.createElement(H);break;default:g=I.createElement("span");YAHOO.util.Dom.addClass(g,"yui-tag-"+H);YAHOO.util.Dom.addClass(g,"yui-tag");g.setAttribute("tag",H);for(var e in U){if(YAHOO.util.Lang.hasOwnProperty(U,e)){g.style[e]=U[e];}}break;}return g;};if(!this._hasSelection()){if(this._getDoc().queryCommandEnabled("insertimage")){this._getDoc().execCommand("insertimage",false,"yui-tmp-img");var W=this._getDoc().getElementsByTagName("img");for(var a=0;a<W.length;a++){if(W[a].getAttribute("src",2)=="yui-tmp-img"){G=X();W[a].parentNode.replaceChild(G,W[a]);this.currentElement[this.currentElement.length]=G;}}}else{if(this.currentEvent){c=YAHOO.util.Event.getTarget(this.currentEvent);}else{c=this._getDoc().body;}}if(c){G=X();if(this._isElement(c,"body")){c.appendChild(G);}else{if(c.nextSibling){c.parentNode.insertBefore(G,c.nextSibling);}else{c.parentNode.appendChild(G);}}this.currentElement[this.currentElement.length]=G;this.currentEvent=null;if(this.browser.webkit){this._getSelection().setBaseAndExtent(G,0,G,0);if(this.browser.webkit3){this._getSelection().collapseToStart();}else{this._getSelection().collapse(true);}}}}else{this._setEditorStyle(true);this._getDoc().execCommand("fontname",false,"yui-tmp");var F=[];var R=this._getDoc().getElementsByTagName("font");var P=this._getDoc().getElementsByTagName(this._getSelectedElement().tagName);var N=this._getDoc().getElementsByTagName("span");var L=this._getDoc().getElementsByTagName("i");var K=this._getDoc().getElementsByTagName("b");var J=this._getDoc().getElementsByTagName(this._getSelectedElement().parentNode.tagName);for(var V=0;V<R.length;V++){F[F.length]=R[V];}for(var M=0;M<J.length;M++){F[F.length]=J[M];}for(var T=0;T<P.length;T++){F[F.length]=P[T];}for(var S=0;S<N.length;S++){F[F.length]=N[S];}for(var Q=0;Q<L.length;Q++){F[F.length]=L[Q];}for(var O=0;O<K.length;O++){F[F.length]=K[O];}for(var b=0;b<F.length;b++){if((YAHOO.util.Dom.getStyle(F[b],"font-family")=="yui-tmp")||(F[b].face&&(F[b].face=="yui-tmp"))){G=X();G.innerHTML=F[b].innerHTML;if(this._isElement(F[b],"ol")||(this._isElement(F[b],"ul"))){var Y=F[b].getElementsByTagName("li")[0];F[b].style.fontFamily="inherit";Y.style.fontFamily="inherit";G.innerHTML=Y.innerHTML;Y.innerHTML="";Y.appendChild(G);this.currentElement[this.currentElement.length]=G;}else{if(this._isElement(F[b],"li")){F[b].innerHTML="";F[b].appendChild(G);F[b].style.fontFamily="inherit";this.currentElement[this.currentElement.length]=G;}else{if(F[b].parentNode){F[b].parentNode.replaceChild(G,F[b]);this.currentElement[this.currentElement.length]=G;this.currentEvent=null;if(this.browser.webkit){this._getSelection().setBaseAndExtent(G,0,G,0);if(this.browser.webkit3){this._getSelection().collapseToStart();}else{this._getSelection().collapse(true);}}if(this.browser.ie&&U&&U.fontSize){this._getSelection().empty();}if(this.browser.gecko){this._getSelection().collapseToStart();}}}}}}var d=this.currentElement.length;for(var f=0;f<d;f++){if((f+1)!=d){if(this.currentElement[f]&&this.currentElement[f].nextSibling){if(this._isElement(this.currentElement[f],"br")){this.currentElement[this.currentElement.length]=this.currentElement[f].nextSibling;}}}}}},saveHTML:function(){var F=this.cleanHTML();this.get("element").value=F;return F;},setEditorHTML:function(F){this._getDoc().body.innerHTML=F;this.nodeChange();},getEditorHTML:function(){return this._getDoc().body.innerHTML;},show:function(){if(this.browser.gecko){this._setDesignMode("on");this._focusWindow();}if(this.browser.webkit){var F=this;window.setTimeout(function(){F._setInitialContent.call(F);
},10);}if(YAHOO.widget.EditorInfo.window.win&&YAHOO.widget.EditorInfo.window.scope){YAHOO.widget.EditorInfo.window.scope.closeWindow.call(YAHOO.widget.EditorInfo.window.scope);}this.get("iframe").setStyle("position","static");this.get("iframe").setStyle("left","");},hide:function(){if(YAHOO.widget.EditorInfo.window.win&&YAHOO.widget.EditorInfo.window.scope){YAHOO.widget.EditorInfo.window.scope.closeWindow.call(YAHOO.widget.EditorInfo.window.scope);}if(this._fixNodesTimer){clearTimeout(this._fixNodesTimer);this._fixNodesTimer=null;}if(this._nodeChangeTimer){clearTimeout(this._nodeChangeTimer);this._nodeChangeTimer=null;}this._lastNodeChange=0;this.get("iframe").setStyle("position","absolute");this.get("iframe").setStyle("left","-9999px");},cleanHTML:function(H){if(!H){H=this.getEditorHTML();}var F=this.get("markup");if(this.browser.webkit){H=H.replace(/<br class="khtml-block-placeholder">/gi,"<YUI_BR>");H=H.replace(/<br class="webkit-block-placeholder">/gi,"<YUI_BR>");}H=H.replace(/<br>/gi,"<YUI_BR>");H=H.replace(/<br\/>/gi,"<YUI_BR>");H=H.replace(/<br \/>/gi,"<YUI_BR>");H=H.replace(/<div><YUI_BR><\/div>/gi,"<YUI_BR>");H=H.replace(/<p>(&nbsp;|&#160;)<\/p>/g,"<YUI_BR>");H=H.replace(/<p><br>&nbsp;<\/p>/gi,"<YUI_BR>");H=H.replace(/<p>&nbsp;<\/p>/gi,"<YUI_BR>");H=H.replace(/<img([^>]*)\/>/gi,"<YUI_IMG$1>");H=H.replace(/<img([^>]*)>/gi,"<YUI_IMG$1>");H=H.replace(/<ul([^>]*)>/gi,"<YUI_UL$1>");H=H.replace(/<\/ul>/gi,"</YUI_UL>");H=H.replace(/<blockquote([^>]*)>/gi,"<YUI_BQ$1>");H=H.replace(/<\/blockquote>/gi,"</YUI_BQ>");if((F=="semantic")||(F=="xhtml")){H=H.replace(/<i([^>]*)>/gi,"<em$1>");H=H.replace(/<\/i>/gi,"</em>");H=H.replace(/<b([^>]*)>/gi,"<strong$1>");H=H.replace(/<\/b>/gi,"</strong>");}H=H.replace(/<font/gi,"<font");H=H.replace(/<\/font>/gi,"</font>");H=H.replace(/<span/gi,"<span");H=H.replace(/<\/span>/gi,"</span>");if((F=="semantic")||(F=="xhtml")||(F=="css")){H=H.replace(new RegExp("<font([^>]*)face=\"([^>]*)\">(.*?)</font>","gi"),"<span $1 style=\"font-family: $2;\">$3</span>");H=H.replace(/<u/gi,"<span style=\"text-decoration: underline;\"");H=H.replace(/\/u>/gi,"/span>");if(F=="css"){H=H.replace(/<em([^>]*)>/gi,"<i$1>");H=H.replace(/<\/em>/gi,"</i>");H=H.replace(/<strong([^>]*)>/gi,"<b$1>");H=H.replace(/<\/strong>/gi,"</b>");H=H.replace(/<b/gi,"<span style=\"font-weight: bold;\"");H=H.replace(/\/b>/gi,"/span>");H=H.replace(/<i/gi,"<span style=\"font-style: italic;\"");H=H.replace(/\/i>/gi,"/span>");}H=H.replace(/  /gi," ");}else{H=H.replace(/<u/gi,"<u");H=H.replace(/\/u>/gi,"/u>");}H=H.replace(/<ol([^>]*)>/gi,"<ol$1>");H=H.replace(/\/ol>/gi,"/ol>");H=H.replace(/<li/gi,"<li");H=H.replace(/\/li>/gi,"/li>");H=H.replace(/<\/?(body|head|html)[^>]*>/gi,"");H=H.replace(/<YUI_BR>$/,"");H=H.replace(/<YUI_BR><\/p>/g,"</p>");H=H.replace(/<YUI_BR><\/li>/gi,"</li>");if(this.browser.webkit){H=H.replace(/Apple-style-span/gi,"");H=H.replace(/style="line-height: normal;"/gi,"");H=H.replace(/<li><\/li>/gi,"");H=H.replace(/<li> <\/li>/gi,"");H=H.replace(/<div><\/div>/gi,"");H=H.replace(/<div> <\/div>/gi,"");}H=H.replace(/yui-tag-span/gi,"");H=H.replace(/yui-tag/gi,"");H=H.replace(/yui-non/gi,"");H=H.replace(/yui-img/gi,"");H=H.replace(/ tag="span"/gi,"");H=H.replace(/ class=""/gi,"");H=H.replace(/ style=""/gi,"");H=H.replace(/ class=" "/gi,"");H=H.replace(/ class="  "/gi,"");H=H.replace(/ target=""/gi,"");H=H.replace(/ title=""/gi,"");for(var G=0;G<5;G++){H=H.replace(new RegExp("<span>(.*?)</span>","gi"),"$1");}if(this.browser.ie){H=H.replace(/ class= /gi,"");H=H.replace(/ class= >/gi,"");H=H.replace(/_height="([^>])"/gi,"");H=H.replace(/_width="([^>])"/gi,"");}if(F=="xhtml"){H=H.replace(/<YUI_BR>/g,"<br/>");H=H.replace(/<YUI_IMG([^>]*)>/g,"<img $1/>");}else{H=H.replace(/<YUI_BR>/g,"<br>");H=H.replace(/<YUI_IMG([^>]*)>/g,"<img $1>");}H=H.replace(/<YUI_UL([^>]*)>/g,"<ul$1>");H=H.replace(/<\/YUI_UL>/g,"</ul>");H=H.replace(/<YUI_BQ([^>]*)>/g,"<blockquote$1>");H=H.replace(/<\/YUI_BQ>/g,"</blockquote>");H=H.replace(/^\s+/g,"").replace(/\s+$/g,"");if(this.get("removeLineBreaks")){H=H.replace(/\n/g,"").replace(/\r/g,"");H=H.replace(/  /gi," ");}return H;},clearEditorDoc:function(){this._getDoc().body.innerHTML="&nbsp;";},_renderPanel:function(){var F=null;if(!YAHOO.widget.EditorInfo.panel){F=new YAHOO.widget.Overlay(this.EDITOR_PANEL_ID,{width:"300px",iframe:true,visible:false,underlay:"none",draggable:false,close:false});YAHOO.widget.EditorInfo.panel=F;}else{F=YAHOO.widget.EditorInfo.panel;}this.set("panel",F);this.get("panel").setBody("---");this.get("panel").setHeader(" ");this.get("panel").setFooter(" ");if(this.DOMReady){this.get("panel").render(document.body);C.addClass(this.get("panel").element,"yui-editor-panel");}else{A.onDOMReady(function(){this.get("panel").render(document.body);C.addClass(this.get("panel").element,"yui-editor-panel");},this,true);}this.get("panel").showEvent.subscribe(function(){YAHOO.util.Dom.setStyle(this.element,"display","block");});return this.get("panel");},openWindow:function(K){this.toolbar.set("disabled",true);A.on(document,"keypress",this._closeWindow,this,true);if(YAHOO.widget.EditorInfo.window.win&&YAHOO.widget.EditorInfo.window.scope){YAHOO.widget.EditorInfo.window.scope.closeWindow.call(YAHOO.widget.EditorInfo.window.scope);}YAHOO.widget.EditorInfo.window.win=K;YAHOO.widget.EditorInfo.window.scope=this;var P=this,L=C.getXY(this.currentElement[0]),U=C.getXY(this.get("iframe").get("element")),N=this.get("panel"),T=[(L[0]+U[0]-20),(L[1]+U[1]+10)],O=(parseInt(K.attrs.width,10)/2),R="center",M=null;this.fireEvent("beforeOpenWindow",{type:"beforeOpenWindow",win:K,panel:N});M=document.createElement("div");M.className=this.CLASS_PREFIX+"-body-cont";for(var V in this.browser){if(this.browser[V]){C.addClass(M,V);break;}}var S=document.createElement("h3");S.className="yui-editor-skipheader";S.innerHTML=this.STR_CLOSE_WINDOW_NOTE;M.appendChild(S);form=document.createElement("form");form.setAttribute("method","GET");var W=K.name;A.on(form,"submit",function(Y){var X="window"+W+"Submit";
P.fireEvent(X,{type:X,target:this});A.stopEvent(Y);},this,true);M.appendChild(form);if(D.isObject(K.body)){form.appendChild(K.body);}else{var F=document.createElement("div");F.innerHTML=K.body;form.appendChild(F);}var J=document.createElement("span");J.innerHTML="X";J.title=this.STR_CLOSE_WINDOW;J.className="close";A.on(J,"click",function(){this.closeWindow();},this,true);var H=document.createElement("span");H.innerHTML="^";H.className="knob";K._knob=H;var I=document.createElement("h3");I.innerHTML=K.header;N.cfg.setProperty("width",K.attrs.width);N.setHeader(" ");N.appendToHeader(I);I.appendChild(J);I.appendChild(H);N.setBody(" ");N.setFooter(" ");if(K.footer!==null){N.setFooter(K.footer);C.addClass(N.footer,"open");}else{C.removeClass(N.footer,"open");}N.appendToBody(M);var Q=function(){N.bringToTop();A.on(N.element,"click",function(X){A.stopPropagation(X);});this._setBusy(true);N.showEvent.unsubscribe(Q);};N.showEvent.subscribe(Q,this,true);var G=function(){this.currentWindow=null;var X="window"+W+"Close";this.fireEvent(X,{type:X,target:this});N.hideEvent.unsubscribe(G);};N.hideEvent.subscribe(G,this,true);this.currentWindow=K;this.moveWindow(true);N.show();this.fireEvent("afterOpenWindow",{type:"afterOpenWindow",win:K,panel:N});},moveWindow:function(G){if(!this.currentWindow){return false;}var I=this.currentWindow,J=C.getXY(this.currentElement[0]),Z=C.getXY(this.get("iframe").get("element")),O=this.get("panel"),X=[(J[0]+Z[0]),(J[1]+Z[1])],Q=(parseInt(I.attrs.width,10)/2),T="center",P=O.cfg.getProperty("xy"),H=I._knob,W=0,L=0,S=false;X[0]=((X[0]-Q)+20);X[0]=X[0]-C.getDocumentScrollLeft(this._getDoc());X[1]=X[1]-C.getDocumentScrollTop(this._getDoc());if(this._isElement(this.currentElement[0],"img")){if(this.currentElement[0].src.indexOf(this.get("blankimage"))!=-1){X[0]=(X[0]+(75/2));X[1]=(X[1]+75);}else{var N=parseInt(this.currentElement[0].width,10);var V=parseInt(this.currentElement[0].height,10);X[0]=(X[0]+(N/2));X[1]=(X[1]+V);}X[1]=X[1]+15;}else{var K=C.getStyle(this.currentElement[0],"fontSize");if(K&&K.indexOf&&K.indexOf("px")!=-1){X[1]=X[1]+parseInt(C.getStyle(this.currentElement[0],"fontSize"),10)+5;}else{X[1]=X[1]+20;}}if(X[0]<Z[0]){X[0]=Z[0]+5;T="left";}if((X[0]+(Q*2))>(Z[0]+parseInt(this.get("iframe").get("element").clientWidth,10))){X[0]=((Z[0]+parseInt(this.get("iframe").get("element").clientWidth,10))-(Q*2)-5);T="right";}try{W=(X[0]-P[0]);L=(X[1]-P[1]);}catch(a){}W=((W<0)?(W*-1):W);L=((L<0)?(L*-1):L);if(((W>10)||(L>10))||G){var R=0,U=0;if(this.currentElement[0].width){U=(parseInt(this.currentElement[0].width,10)/2);}var M=J[0]+Z[0]+U;R=M-X[0];if(R>(parseInt(I.attrs.width,10)-40)){R=parseInt(I.attrs.width,10)-40;}else{if(R<40){R=40;}}if(isNaN(R)){R=40;}if(G){if(H){H.style.left=R+"px";}if(this.get("animate")){C.setStyle(O.element,"opacity","0");S=new YAHOO.util.Anim(O.element,{opacity:{from:0,to:1}},0.1,YAHOO.util.Easing.easeOut);O.cfg.setProperty("xy",X);S.onComplete.subscribe(function(){if(this.browser.ie){O.element.style.filter="none";}},this,true);S.animate();}else{O.cfg.setProperty("xy",X);}}else{if(this.get("animate")){S=new YAHOO.util.Anim(O.element,{},0.5,YAHOO.util.Easing.easeOut);S.attributes={top:{to:X[1]},left:{to:X[0]}};S.onComplete.subscribe(function(){O.cfg.setProperty("xy",X);});var Y=new YAHOO.util.Anim(O.iframe,S.attributes,0.5,YAHOO.util.Easing.easeOut);var F=new YAHOO.util.Anim(H,{left:{to:R}},0.6,YAHOO.util.Easing.easeOut);S.animate();Y.animate();F.animate();}else{H.style.left=R+"px";O.cfg.setProperty("xy",X);}}}},_closeWindow:function(F){if((F.charCode==87)&&F.shiftKey&&F.ctrlKey){if(this.currentWindow){this.closeWindow();}}},closeWindow:function(){YAHOO.widget.EditorInfo.window={};this.fireEvent("closeWindow",{type:"closeWindow",win:this.currentWindow});this.currentWindow=null;this.get("panel").hide();this.get("panel").cfg.setProperty("xy",[-900,-900]);this.get("panel").syncIframe();this.unsubscribeAll("afterExecCommand");this.toolbar.set("disabled",false);this.toolbar.resetAllButtons();this._focusWindow();A.removeListener(document,"keypress",this._closeWindow);},destroy:function(){this.saveHTML();this.toolbar.destroy();this.setStyle("visibility","hidden");this.setStyle("position","absolute");this.setStyle("top","-9999px");this.setStyle("left","-9999px");var G=this.get("element");this.get("element_cont").get("parentNode").replaceChild(G,this.get("element_cont").get("element"));this.get("element_cont").get("element").innerHTML="";for(var F in this){if(D.hasOwnProperty(this,F)){this[F]=null;}}return true;},toString:function(){var F="Editor";if(this.get&&this.get("element_cont")){F="Editor (#"+this.get("element_cont").get("id")+")"+((this.get("disabled")?" Disabled":""));}return F;}});YAHOO.widget.EditorInfo={_instances:{},window:{},panel:null,getEditorById:function(F){if(!YAHOO.lang.isString(F)){F=F.id;}if(this._instances[F]){return this._instances[F];}return false;},toString:function(){var F=0;for(var G in this._instances){F++;}return"Editor Info ("+F+" registered intance"+((F>1)?"s":"")+")";}};YAHOO.widget.EditorWindow=function(G,F){this.name=G.replace(" ","_");this.attrs=F;};YAHOO.widget.EditorWindow.prototype={_cache:null,header:null,body:null,footer:null,setHeader:function(F){this.header=F;},setBody:function(F){this.body=F;},setFooter:function(F){this.footer=F;},toString:function(){return"Editor Window ("+this.name+")";}};})();YAHOO.register("editor",YAHOO.widget.Editor,{version:"2.3.1",build:"541"});